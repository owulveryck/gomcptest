<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="https://owulveryck.github.io/gomcptest/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="https://owulveryck.github.io/gomcptest/docs/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/gomcptest/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/gomcptest/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/gomcptest/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/gomcptest/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/gomcptest/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/gomcptest/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/gomcptest/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/gomcptest/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/gomcptest/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/gomcptest/favicons/android-192x192.png" sizes="192x192">

<title>Documentation | GoMCPTest</title>
<meta name="description" content="gomcptest is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.
gomcptest Documentation Welcome to the gomcptest documentation. This project is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.
Documentation Structure Our documentation follows the Divio Documentation Framework, which organizes content into four distinct types: tutorials, how-to guides, reference, and explanation. This approach ensures that different learning needs are addressed with the appropriate content format.">
<meta property="og:url" content="https://owulveryck.github.io/gomcptest/docs/">
  <meta property="og:site_name" content="GoMCPTest">
  <meta property="og:title" content="Documentation">
  <meta property="og:description" content="gomcptest is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.
gomcptest Documentation Welcome to the gomcptest documentation. This project is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.
Documentation Structure Our documentation follows the Divio Documentation Framework, which organizes content into four distinct types: tutorials, how-to guides, reference, and explanation. This approach ensures that different learning needs are addressed with the appropriate content format.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="Documentation">
  <meta itemprop="description" content="gomcptest is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.
gomcptest Documentation Welcome to the gomcptest documentation. This project is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.
Documentation Structure Our documentation follows the Divio Documentation Framework, which organizes content into four distinct types: tutorials, how-to guides, reference, and explanation. This approach ensures that different learning needs are addressed with the appropriate content format.">
  <meta itemprop="dateModified" content="2025-09-12T10:47:18+02:00">
  <meta itemprop="wordCount" content="695">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Documentation">
  <meta name="twitter:description" content="gomcptest is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.
gomcptest Documentation Welcome to the gomcptest documentation. This project is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.
Documentation Structure Our documentation follows the Divio Documentation Framework, which organizes content into four distinct types: tutorials, how-to guides, reference, and explanation. This approach ensures that different learning needs are addressed with the appropriate content format.">
<link rel="preload" href="/gomcptest/scss/main.min.48c25d0a5a23a1e8cae94d6c5e7622061e5345cf098171b1d6ee41d8e309e6c8.css" as="style" integrity="sha256-SMJdClojoejK6U1sXnYiBh5TRc8JgXGx1u5B2OMJ5sg=" crossorigin="anonymous">
<link href="/gomcptest/scss/main.min.48c25d0a5a23a1e8cae94d6c5e7622061e5345cf098171b1d6ee41d8e309e6c8.css" rel="stylesheet" integrity="sha256-SMJdClojoejK6U1sXnYiBh5TRc8JgXGx1u5B2OMJ5sg=" crossorigin="anonymous">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/gomcptest/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">GoMCPTest</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/gomcptest/docs/"><span>Docs</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">English</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/gomcptest/fr/docs/">Fran√ßais</a></li>
    </ul>
</div></li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/gomcptest/docs/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Documentation</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-68ec2370d0409cc27325be36693f9368">Tutorials</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>1.1: <a href="#pg-fde8652c74594a64ff8ea9829ed8ccb8">Getting Started with gomcptest</a></li>


    
  
    
    
	
<li>1.2: <a href="#pg-d1e31c239e3f4bb5c0ff07585d9d378e">Building Your First OpenAI-Compatible Server</a></li>


    
  
    
    
	
<li>1.3: <a href="#pg-278c15abdb8d424b0feb1afd5bd2949e">Using the cliGCP Command Line Interface</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-3ed42a366033a73c16952def2baeb723">How-To Guides</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.1: <a href="#pg-1b0984aa513cab2c3fab92be432b3edd">How to Create a Custom MCP Tool</a></li>


    
  
    
    
	
<li>2.2: <a href="#pg-698eac74d7be52f0ac1350e89ad0e597">How to Configure the OpenAI-Compatible Server</a></li>


    
  
    
    
	
<li>2.3: <a href="#pg-0593b1249420a69082646ae587a17e4e">How to Configure the cliGCP Command Line Interface</a></li>


    
  
    
    
	
<li>2.4: <a href="#pg-ae5e1f7351270a62eef2bc0be0c0f670">How to Use the OpenAI Server with big-AGI</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-b00a88a07ceb21b1a83e5822e0c86c1d">Reference</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-4f002b9458521ca7afd32176fd590646">Tools Reference</a></li>


    
  
    
    
	
<li>3.2: <a href="#pg-61ac8e48954ec034d3d42bf3a56d2966">OpenAI-Compatible Server Reference</a></li>


    
  
    
    
	
<li>3.3: <a href="#pg-2d55ee040b4d2da5feeb8c0dc85e1391">cliGCP Reference (Deprecated)</a></li>


    
  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-85582929df2cd71a593c6114cfeed168">Explanation</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-b0b996368ba948f31e52a0671d2c62fe">gomcptest Architecture</a></li>


    
  
    
    
	
<li>4.2: <a href="#pg-090f1260bedc244a0c4b89f7e6660bd9">Understanding the Model Context Protocol (MCP)</a></li>


    
  
    
    
	
<li>4.3: <a href="#pg-ec0891f28a646da37c980769da51b225">Event System Architecture</a></li>


    
  
    
    
	
<li>4.4: <a href="#pg-dfb825df92428ce7ba378cf65f53a5ca">Understanding the MCP Tools</a></li>


    
  
    
    
	
<li>4.5: <a href="#pg-cc9d8f3effc7306c99038e88b638b5a1">AgentFlow: Event-Driven Interface Implementation</a></li>


    
  

    </ul>
    
  

    </ul>


<div class="content">
      

<div class="pageinfo pageinfo-primary">
<p>gomcptest is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.</p>

</div>

<h1 id="gomcptest-documentation">gomcptest Documentation<a class="td-heading-self-link" href="#gomcptest-documentation" aria-label="Heading self-link"></a></h1>
<p>Welcome to the gomcptest documentation. This project is a proof of concept (POC) demonstrating how to implement a Model Context Protocol (MCP) with a custom-built host to play with agentic systems.</p>
<h2 id="documentation-structure">Documentation Structure<a class="td-heading-self-link" href="#documentation-structure" aria-label="Heading self-link"></a></h2>
<p>Our documentation follows the <a href="https://documentation.divio.com/">Divio Documentation Framework</a>, which organizes content into four distinct types: tutorials, how-to guides, reference, and explanation. This approach ensures that different learning needs are addressed with the appropriate content format.</p>
<h2 id="tutorials-learning-oriented-content">Tutorials: Learning-oriented content<a class="td-heading-self-link" href="#tutorials-learning-oriented-content" aria-label="Heading self-link"></a></h2>
<p>Tutorials are lessons that take you by the hand through a series of steps to complete a project. They focus on learning by doing, and help beginners get started with the system.</p>
<table>
  <thead>
      <tr>
          <th>Tutorial</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="/gomcptest/docs/tutorials/getting-started/">Getting Started with gomcptest</a></td>
          <td>A complete beginner&rsquo;s guide to setting up the environment, building tools, and running your first agent with the AgentFlow UI. Perfect for first-time users.</td>
      </tr>
      <tr>
          <td><a href="/gomcptest/docs/tutorials/openaiserver-tutorial/">Building Your First OpenAI-Compatible Server</a></td>
          <td>Step-by-step instructions for running and configuring the OpenAI-compatible server with the modern AgentFlow web interface.</td>
      </tr>
      <tr>
          <td><a href="/gomcptest/docs/tutorials/cligcp-tutorial/">Using the cliGCP Command Line Interface</a></td>
          <td><strong>‚ö†Ô∏è DEPRECATED</strong>: Legacy guide for the cliGCP tool. Use AgentFlow UI instead.</td>
      </tr>
  </tbody>
</table>
<h2 id="how-to-guides-problem-oriented-content">How-to Guides: Problem-oriented content<a class="td-heading-self-link" href="#how-to-guides-problem-oriented-content" aria-label="Heading self-link"></a></h2>
<p>How-to guides are recipes that guide you through the steps involved in addressing key problems and use cases. They are practical and goal-oriented.</p>
<table>
  <thead>
      <tr>
          <th>How-to Guide</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="/gomcptest/docs/how-to/create-custom-tool/">How to Create a Custom MCP Tool</a></td>
          <td>Practical steps to create a new custom tool compatible with the Model Context Protocol, including code templates and examples.</td>
      </tr>
      <tr>
          <td><a href="/gomcptest/docs/how-to/configure-openaiserver/">How to Configure the OpenAI-Compatible Server</a></td>
          <td>Solutions for configuring and customizing the OpenAI server with AgentFlow UI, including environment variables, Vertex AI tools, and production setup.</td>
      </tr>
      <tr>
          <td><a href="/gomcptest/docs/how-to/configure-cligcp/">How to Configure the cliGCP Command Line Interface</a></td>
          <td><strong>‚ö†Ô∏è DEPRECATED</strong>: Legacy configuration guide. Use AgentFlow UI configuration instead.</td>
      </tr>
  </tbody>
</table>
<h2 id="reference-information-oriented-content">Reference: Information-oriented content<a class="td-heading-self-link" href="#reference-information-oriented-content" aria-label="Heading self-link"></a></h2>
<p>Reference guides are technical descriptions of the machinery and how to operate it. They describe how things work in detail and are accurate and complete.</p>
<table>
  <thead>
      <tr>
          <th>Reference</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="/gomcptest/docs/reference/tools/">Tools Reference</a></td>
          <td>Comprehensive reference of all available MCP-compatible tools, their parameters, response formats, and error handling.</td>
      </tr>
      <tr>
          <td><a href="/gomcptest/docs/reference/openaiserver/">OpenAI-Compatible Server Reference</a></td>
          <td>Technical documentation of the server&rsquo;s architecture, AgentFlow UI, API endpoints, configuration options, and Vertex AI integration.</td>
      </tr>
      <tr>
          <td><a href="/gomcptest/docs/reference/cligcp/">cliGCP Reference</a></td>
          <td><strong>‚ö†Ô∏è DEPRECATED</strong>: Legacy CLI reference. Use AgentFlow UI instead.</td>
      </tr>
  </tbody>
</table>
<h2 id="explanation-understanding-oriented-content">Explanation: Understanding-oriented content<a class="td-heading-self-link" href="#explanation-understanding-oriented-content" aria-label="Heading self-link"></a></h2>
<p>Explanation documents discuss and clarify concepts to broaden the reader&rsquo;s understanding of topics. They provide context and illuminate ideas.</p>
<table>
  <thead>
      <tr>
          <th>Explanation</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="/gomcptest/docs/explanation/architecture/">gomcptest Architecture</a></td>
          <td>Deep dive into the system architecture, design decisions, and how the various components interact to create a custom MCP host.</td>
      </tr>
      <tr>
          <td><a href="/gomcptest/docs/explanation/mcp-protocol/">Understanding the Model Context Protocol (MCP)</a></td>
          <td>Exploration of what MCP is, how it works, design decisions behind it, and how it compares to alternative approaches for LLM tool integration.</td>
      </tr>
      <tr>
          <td><a href="/gomcptest/docs/explanation/agentflow/">AgentFlow: Modern Web Interface</a></td>
          <td>Comprehensive guide to AgentFlow&rsquo;s features including tool selection, real-time event notifications, mobile optimization, and conversation management.</td>
      </tr>
  </tbody>
</table>
<h2 id="project-components">Project Components<a class="td-heading-self-link" href="#project-components" aria-label="Heading self-link"></a></h2>
<p>gomcptest consists of several key components that work together:</p>
<h3 id="host-components">Host Components<a class="td-heading-self-link" href="#host-components" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>OpenAI-compatible server</strong> (<code>host/openaiserver</code>): A server that implements the OpenAI API interface and connects to Google&rsquo;s Vertex AI for model inference. Includes the modern <strong>AgentFlow web UI</strong> for interactive chat.</li>
<li><strong>cliGCP</strong> (<code>host/cliGCP</code>): <strong>‚ö†Ô∏è DEPRECATED</strong> - Legacy command-line interface. Use the AgentFlow web UI instead.</li>
</ul>
<h3 id="agentflow-web-ui">AgentFlow Web UI<a class="td-heading-self-link" href="#agentflow-web-ui" aria-label="Heading self-link"></a></h3>
<p>The modern web-based interface is <strong>embedded in the openaiserver binary</strong> and provides:</p>
<ul>
<li><strong>Mobile-optimized design</strong> with Apple touch icon support</li>
<li><strong>Real-time streaming responses</strong> via Server-Sent Events</li>
<li><strong>Professional styling</strong> with accessibility features</li>
<li><strong>Conversation management</strong> with persistent history</li>
<li><strong>File upload support</strong> including PDFs</li>
<li><strong>Embedded architecture</strong> for easy deployment via <code>/ui</code> endpoint</li>
</ul>
<p>Access AgentFlow by running <code>./bin/openaiserver</code> and visiting <code>http://localhost:8080/ui</code></p>
<h3 id="tools">Tools<a class="td-heading-self-link" href="#tools" aria-label="Heading self-link"></a></h3>
<p>The <code>tools</code> directory contains various MCP-compatible tools:</p>
<h4 id="file-system-operations">File System Operations<a class="td-heading-self-link" href="#file-system-operations" aria-label="Heading self-link"></a></h4>
<ul>
<li><strong>Bash</strong>: Executes bash commands in a persistent shell session</li>
<li><strong>Edit</strong>: Modifies file content by replacing specified text</li>
<li><strong>GlobTool</strong>: Finds files matching glob patterns</li>
<li><strong>GrepTool</strong>: Searches file contents using regular expressions</li>
<li><strong>LS</strong>: Lists files and directories</li>
<li><strong>Replace</strong>: Completely replaces a file&rsquo;s contents</li>
<li><strong>View</strong>: Reads file contents</li>
</ul>
<h4 id="image-and-diagram-tools">Image and Diagram Tools<a class="td-heading-self-link" href="#image-and-diagram-tools" aria-label="Heading self-link"></a></h4>
<ul>
<li><strong>imagen</strong>: Generates images using Google&rsquo;s Imagen API</li>
<li><strong>imagen_edit</strong>: Edits images using natural language instructions</li>
<li><strong>plantuml</strong>: Generates PlantUML diagram URLs with syntax validation</li>
<li><strong>plantuml_check</strong>: Validates PlantUML file syntax</li>
</ul>
<h4 id="data-and-utility-tools">Data and Utility Tools<a class="td-heading-self-link" href="#data-and-utility-tools" aria-label="Heading self-link"></a></h4>
<ul>
<li><strong>duckdbserver</strong>: Provides SQL-based data processing with DuckDB</li>
<li><strong>dispatch_agent</strong>: Launches specialized sub-agents for specific tasks</li>
<li><strong>sleep</strong>: Pauses execution for testing and demonstrations</li>
</ul>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-68ec2370d0409cc27325be36693f9368">1 - Tutorials</h1>
    <div class="lead">Step-by-step guides to get you started with gomcptest</div>
	

<div class="pageinfo pageinfo-primary">
<p>Tutorials are learning-oriented guides that take you through a series of steps to complete a project. They focus on learning by doing, and helping beginners get started with the system.</p>

</div>

<p>These tutorials will help you get familiar with gomcptest and its components.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-fde8652c74594a64ff8ea9829ed8ccb8">1.1 - Getting Started with gomcptest</h1>
    <div class="lead">Get gomcptest up and running quickly with this beginner&rsquo;s guide</div>
	<p>This tutorial will take you through building and running your first AI agent system with gomcptest. By the end, you&rsquo;ll have a working agent that can help you manage files and execute commands on your system.</p>


<div class="pageinfo pageinfo-primary">
<p><strong>What you&rsquo;ll accomplish</strong>: Set up gomcptest, build the tools, and have your first conversation with an AI agent that can actually help you with real tasks.</p>
<p>For background on what gomcptest is and how it works, see the <a href="../../explanation/architecture/">Architecture explanation</a>.</p>

</div>

<h2 id="prerequisites">Prerequisites<a class="td-heading-self-link" href="#prerequisites" aria-label="Heading self-link"></a></h2>
<ul>
<li>Go &gt;= 1.21 installed on your system</li>
<li>Google Cloud account with access to Vertex AI API</li>
<li><a href="https://cloud.google.com/sdk/docs/install">Google Cloud CLI</a> installed</li>
<li>Basic familiarity with terminal/command line</li>
</ul>
<h2 id="setting-up-google-cloud-authentication">Setting up Google Cloud Authentication<a class="td-heading-self-link" href="#setting-up-google-cloud-authentication" aria-label="Heading self-link"></a></h2>
<p>Before using gomcptest with Google Cloud Platform services like Vertex AI, you need to set up your authentication.</p>
<h3 id="1-initialize-the-google-cloud-cli">1. Initialize the Google Cloud CLI<a class="td-heading-self-link" href="#1-initialize-the-google-cloud-cli" aria-label="Heading self-link"></a></h3>
<p>If you haven&rsquo;t already configured the Google Cloud CLI, run:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud init
</span></span></code></pre></div><p>This interactive command will guide you through:</p>
<ul>
<li>Logging into your Google account</li>
<li>Selecting a Google Cloud project</li>
<li>Setting default configurations</li>
</ul>
<h3 id="2-log-in-to-google-cloud">2. Log in to Google Cloud<a class="td-heading-self-link" href="#2-log-in-to-google-cloud" aria-label="Heading self-link"></a></h3>
<p>Authenticate your gcloud CLI with your Google account:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud auth login
</span></span></code></pre></div><p>This will open a browser window where you can sign in to your Google account.</p>
<h3 id="3-set-up-application-default-credentials-adc">3. Set up Application Default Credentials (ADC)<a class="td-heading-self-link" href="#3-set-up-application-default-credentials-adc" aria-label="Heading self-link"></a></h3>
<p>Application Default Credentials are used by client libraries to automatically find credentials when connecting to Google Cloud services:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud auth application-default login
</span></span></code></pre></div><p>This command will:</p>
<ol>
<li>Open a browser window for authentication</li>
<li>Store your credentials locally (typically in <code>~/.config/gcloud/application_default_credentials.json</code>)</li>
<li>Configure your environment to use these credentials when accessing Google Cloud APIs</li>
</ol>
<p>These credentials will be used by gomcptest when interacting with Google Cloud services.</p>
<h2 id="project-setup">Project Setup<a class="td-heading-self-link" href="#project-setup" aria-label="Heading self-link"></a></h2>
<ol>
<li>
<p><strong>Clone the repository</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/owulveryck/gomcptest.git
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> gomcptest
</span></span></code></pre></div></li>
<li>
<p><strong>Build All Components</strong>: Compile tools and servers using the root Makefile</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Build all tools and servers</span>
</span></span><span style="display:flex;"><span>make all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Or build only tools</span>
</span></span><span style="display:flex;"><span>make tools
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Or build only servers</span>
</span></span><span style="display:flex;"><span>make servers
</span></span></code></pre></div></li>
<li>
<p><strong>Set up your environment</strong>: Configure Google Cloud Project</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Set your project ID (replace with your actual project ID)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;your-project-id&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_REGION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;us-central1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GEMINI_MODELS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;gemini-2.0-flash&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PORT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">8080</span>
</span></span></code></pre></div></li>
</ol>
<h2 id="step-4-start-your-first-ai-agent">Step 4: Start Your First AI Agent<a class="td-heading-self-link" href="#step-4-start-your-first-ai-agent" aria-label="Heading self-link"></a></h2>
<p>Now let&rsquo;s start the OpenAI-compatible server with the AgentFlow web interface:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> host/openaiserver
</span></span><span style="display:flex;"><span>go run . -mcpservers <span style="color:#4e9a06">&#34;../../bin/LS;../../bin/View;../../bin/Bash;../../bin/GlobTool&#34;</span>
</span></span></code></pre></div><p>You should see output like:</p>
<pre tabindex="0"><code>2024/01/15 10:30:00 Starting OpenAI-compatible server on port 8080
2024/01/15 10:30:00 Registered MCP tool: LS
2024/01/15 10:30:00 Registered MCP tool: View  
2024/01/15 10:30:00 Registered MCP tool: Bash
2024/01/15 10:30:00 Registered MCP tool: GlobTool
2024/01/15 10:30:00 AgentFlow UI available at: http://localhost:8080/ui
</code></pre><h2 id="step-5-have-your-first-agent-conversation">Step 5: Have Your First Agent Conversation<a class="td-heading-self-link" href="#step-5-have-your-first-agent-conversation" aria-label="Heading self-link"></a></h2>
<ol>
<li>
<p><strong>Open the AgentFlow UI</strong>: Navigate to <code>http://localhost:8080/ui</code> in your browser</p>
</li>
<li>
<p><strong>Test basic interaction</strong>: Type this message in the chat:</p>
<pre tabindex="0"><code>Hello! Can you help me understand what files are in the current directory?
</code></pre></li>
<li>
<p><strong>Watch the magic happen</strong>: You&rsquo;ll see:</p>
<ul>
<li>The AI agent decides to use the LS tool</li>
<li>A blue notification appears showing &ldquo;Calling tool: LS&rdquo;</li>
<li>The tool executes and shows your directory contents</li>
<li>The AI explains what it found</li>
</ul>
</li>
<li>
<p><strong>Try a more advanced task</strong>: Ask the agent:</p>
<pre tabindex="0"><code>Find all .go files in this project and tell me about the project structure
</code></pre><p>Watch as the agent:</p>
<ul>
<li>Uses GlobTool to find .go files</li>
<li>Uses View to examine some files</li>
<li>Gives you an analysis of the project structure</li>
</ul>
</li>
</ol>
<h2 id="congratulations-">Congratulations! üéâ<a class="td-heading-self-link" href="#congratulations-" aria-label="Heading self-link"></a></h2>
<p>You&rsquo;ve just built and run your first AI agent system! Your agent can now:</p>
<ul>
<li>‚úÖ Navigate your file system</li>
<li>‚úÖ Read file contents</li>
<li>‚úÖ Execute commands</li>
<li>‚úÖ Find files matching patterns</li>
<li>‚úÖ Provide intelligent analysis of what it discovers</li>
</ul>
<h2 id="what-youve-learned">What You&rsquo;ve Learned<a class="td-heading-self-link" href="#what-youve-learned" aria-label="Heading self-link"></a></h2>
<p>Through this hands-on experience, you&rsquo;ve:</p>
<ul>
<li>Set up authentication with Google Cloud</li>
<li>Built MCP-compatible tools from source</li>
<li>Started an OpenAI-compatible server</li>
<li>Used the AgentFlow web interface</li>
<li>Watched an AI agent use tools to accomplish real tasks</li>
</ul>
<h2 id="next-steps">Next Steps<a class="td-heading-self-link" href="#next-steps" aria-label="Heading self-link"></a></h2>
<p>Now that your agent is working, explore what else it can do:</p>
<ul>
<li>Try the <a href="../openaiserver-tutorial/">OpenAI Server Tutorial</a> to learn about advanced features</li>
<li>Read about <a href="../../how-to/create-custom-tool/">Creating Custom Tools</a> to extend your agent&rsquo;s capabilities</li>
<li>Learn about the <a href="../../explanation/event-system/">Event System</a> to understand how the real-time notifications work</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d1e31c239e3f4bb5c0ff07585d9d378e">1.2 - Building Your First OpenAI-Compatible Server</h1>
    <div class="lead">Set up and run an OpenAI-compatible server with AgentFlow UI for interactive tool management and real-time event monitoring</div>
	<p>This tutorial will guide you step-by-step through running and configuring the OpenAI-compatible server in gomcptest with the AgentFlow web interface. By the end, you&rsquo;ll have a working server with a modern UI that provides tool selection, real-time event monitoring, and interactive chat capabilities.</p>
<h2 id="prerequisites">Prerequisites<a class="td-heading-self-link" href="#prerequisites" aria-label="Heading self-link"></a></h2>
<ul>
<li>Go &gt;= 1.21 installed</li>
<li>Access to Google Cloud Platform with Vertex AI API enabled</li>
<li>GCP authentication set up via <code>gcloud auth login</code></li>
<li>Basic familiarity with terminal commands</li>
<li>The gomcptest repository cloned and tools built (see the <a href="../getting-started/">Getting Started</a> guide)</li>
</ul>
<h2 id="step-1-set-up-environment-variables">Step 1: Set Up Environment Variables<a class="td-heading-self-link" href="#step-1-set-up-environment-variables" aria-label="Heading self-link"></a></h2>
<p>The OpenAI server requires several environment variables. Create a .envrc file in the host/openaiserver directory:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> host/openaiserver
</span></span><span style="display:flex;"><span>touch .envrc
</span></span></code></pre></div><p>Add the following content to the .envrc file, adjusting the values according to your setup:</p>
<pre tabindex="0"><code># Server configuration
PORT=8080
LOG_LEVEL=INFO

# GCP configuration
GCP_PROJECT=your-gcp-project-id
GCP_REGION=us-central1
GEMINI_MODELS=gemini-2.0-flash
</code></pre><p><strong>Note</strong>: <code>IMAGE_DIR</code> and <code>IMAGEN_MODELS</code> environment variables are no longer needed for the openaiserver host. Image generation is now handled by the independent <code>tools/imagen</code> MCP server.</p>
<p>Load the environment variables:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">source</span> .envrc
</span></span></code></pre></div><h2 id="step-2-start-the-openai-server-with-agentflow-ui">Step 2: Start the OpenAI Server with AgentFlow UI<a class="td-heading-self-link" href="#step-2-start-the-openai-server-with-agentflow-ui" aria-label="Heading self-link"></a></h2>
<p>Now you can start the OpenAI-compatible server with the embedded AgentFlow interface:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> host/openaiserver
</span></span><span style="display:flex;"><span>go run . -mcpservers <span style="color:#4e9a06">&#34;../bin/GlobTool;../bin/GrepTool;../bin/LS;../bin/View;../bin/Bash;../bin/Replace&#34;</span>
</span></span></code></pre></div><p>You should see output indicating that the server has started and registered the MCP tools.</p>
<h2 id="step-3-access-the-agentflow-web-interface">Step 3: Access the AgentFlow Web Interface<a class="td-heading-self-link" href="#step-3-access-the-agentflow-web-interface" aria-label="Heading self-link"></a></h2>
<p>Open your web browser and navigate to:</p>
<pre tabindex="0"><code>http://localhost:8080/ui
</code></pre><p>You&rsquo;ll see the AgentFlow interface with:</p>
<ul>
<li><strong>Modern chat interface</strong> with mobile-optimized design</li>
<li><strong>Tool selection dropdown</strong> showing all available MCP tools (GlobTool, GrepTool, LS, View, Bash, Replace)</li>
<li><strong>Model selection</strong> with Vertex AI tools support</li>
<li><strong>Real-time event monitoring</strong> for tool calls and responses</li>
</ul>
<h3 id="using-tool-selection">Using Tool Selection<a class="td-heading-self-link" href="#using-tool-selection" aria-label="Heading self-link"></a></h3>
<ol>
<li><strong>View Available Tools</strong>: Click the &ldquo;Tools: All&rdquo; button to see the tool dropdown</li>
<li><strong>Select Specific Tools</strong>: Uncheck tools you don&rsquo;t want to use for focused interactions</li>
<li><strong>Tool Information</strong>: Each tool shows its name and description</li>
<li><strong>Apply Selection</strong>: Your selection is automatically applied to new conversations</li>
</ol>
<h3 id="monitoring-tool-events">Monitoring Tool Events<a class="td-heading-self-link" href="#monitoring-tool-events" aria-label="Heading self-link"></a></h3>
<p>As you interact with the AI agent, you&rsquo;ll see real-time notifications when:</p>
<ul>
<li><strong>Tool Calls</strong>: Blue notifications appear when the AI decides to use a tool</li>
<li><strong>Tool Responses</strong>: Results are displayed as they complete</li>
<li><strong>Event Details</strong>: Click notifications to see detailed tool arguments and responses</li>
</ul>
<h2 id="step-4-test-agentflow-with-interactive-chat">Step 4: Test AgentFlow with Interactive Chat<a class="td-heading-self-link" href="#step-4-test-agentflow-with-interactive-chat" aria-label="Heading self-link"></a></h2>
<p>In the AgentFlow interface, try these interactive examples:</p>
<h3 id="basic-chat-test">Basic Chat Test<a class="td-heading-self-link" href="#basic-chat-test" aria-label="Heading self-link"></a></h3>
<ol>
<li>Type in the chat input: &ldquo;Hello, what can you do?&rdquo;</li>
<li>Send the message and observe the response</li>
<li>Notice how the AI explains its capabilities and available tools</li>
</ol>
<h3 id="tool-interaction-test">Tool Interaction Test<a class="td-heading-self-link" href="#tool-interaction-test" aria-label="Heading self-link"></a></h3>
<ol>
<li>Ask: &ldquo;List the files in the current directory&rdquo;</li>
<li>Watch as AgentFlow shows:
<ul>
<li><strong>Tool Call Notification</strong>: &ldquo;Calling tool: LS&rdquo; appears immediately</li>
<li><strong>Tool Call Popup</strong>: Shows the LS tool being called with its arguments</li>
<li><strong>Tool Response</strong>: Displays the directory listing result</li>
<li><strong>AI Response</strong>: The model interprets and explains the results</li>
</ul>
</li>
</ol>
<h3 id="tool-selection-test">Tool Selection Test<a class="td-heading-self-link" href="#tool-selection-test" aria-label="Heading self-link"></a></h3>
<ol>
<li>Click &ldquo;Tools: All&rdquo; to open the tool selector</li>
<li>Uncheck all tools except &ldquo;View&rdquo; and &ldquo;LS&rdquo;</li>
<li>Ask: &ldquo;Show me the contents of README.md&rdquo;</li>
<li>Notice how the AI can only use the selected tools (View for reading, LS for listing)</li>
</ol>
<h3 id="event-monitoring">Event Monitoring<a class="td-heading-self-link" href="#event-monitoring" aria-label="Heading self-link"></a></h3>
<p>Throughout your interactions, observe:</p>
<ul>
<li><strong>Real-time Events</strong>: Tool calls appear instantly as blue notifications</li>
<li><strong>Event History</strong>: All tool interactions are preserved in the chat</li>
<li><strong>Detailed Information</strong>: Click on tool notifications to see arguments and responses</li>
</ul>
<h2 id="step-5-alternative-api-testing-optional">Step 5: Alternative API Testing (Optional)<a class="td-heading-self-link" href="#step-5-alternative-api-testing-optional" aria-label="Heading self-link"></a></h2>
<p>You can also test the server programmatically using curl:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://localhost:8080/v1/chat/completions <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>  -H <span style="color:#4e9a06">&#34;Content-Type: application/json&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>  -d <span style="color:#4e9a06">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">    &#34;model&#34;: &#34;gemini-2.0-flash&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">    &#34;messages&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">      {
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">        &#34;role&#34;: &#34;user&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">        &#34;content&#34;: &#34;List the files in the current directory&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">      }
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">    ]
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">  }&#39;</span>
</span></span></code></pre></div><p>However, the AgentFlow UI provides much richer feedback and interaction capabilities.</p>
<h2 id="what-youve-learned">What You&rsquo;ve Learned<a class="td-heading-self-link" href="#what-youve-learned" aria-label="Heading self-link"></a></h2>
<p>In this tutorial, you&rsquo;ve:</p>
<ol>
<li>Set up the environment for the OpenAI-compatible server with AgentFlow UI</li>
<li>Built and registered MCP tools</li>
<li>Started the server with embedded web interface</li>
<li>Accessed the modern AgentFlow web interface</li>
<li>Used interactive tool selection and monitoring</li>
<li>Experienced real-time tool event notifications</li>
<li>Tested both UI and API interactions</li>
</ol>
<h2 id="key-agentflow-features-demonstrated">Key AgentFlow Features Demonstrated<a class="td-heading-self-link" href="#key-agentflow-features-demonstrated" aria-label="Heading self-link"></a></h2>
<ul>
<li><strong>Tool Selection</strong>: Granular control over which tools are available to the AI</li>
<li><strong>Real-time Events</strong>: Live monitoring of tool calls and responses</li>
<li><strong>Event Notifications</strong>: Visual feedback for tool interactions</li>
<li><strong>Mobile Optimization</strong>: Responsive design that works on all devices</li>
<li><strong>Interactive Chat</strong>: Modern conversation interface with rich formatting</li>
</ul>
<h2 id="next-steps">Next Steps<a class="td-heading-self-link" href="#next-steps" aria-label="Heading self-link"></a></h2>
<p>Now that you have a working AgentFlow-enabled server, you can:</p>
<ul>
<li><strong>Explore Advanced Features</strong>: Learn more about <a href="../../explanation/agentflow/">AgentFlow&rsquo;s capabilities</a></li>
<li><strong>Configure Advanced Settings</strong>: Check out the <a href="../../how-to/configure-openaiserver/">OpenAI Server Configuration Guide</a></li>
<li><strong>Create Custom Tools</strong>: Follow the <a href="../../how-to/create-custom-tool/">Custom Tool Creation Guide</a></li>
<li><strong>Experiment with Models</strong>: Try different Gemini models and Vertex AI tools</li>
<li><strong>Mobile Usage</strong>: Install AgentFlow as a Progressive Web App on your mobile device</li>
</ul>
<p>For detailed information about tool selection, event monitoring, and other AgentFlow features, see the comprehensive <a href="../../explanation/agentflow/">AgentFlow Documentation</a>.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-278c15abdb8d424b0feb1afd5bd2949e">1.3 - Using the cliGCP Command Line Interface</h1>
    <div class="lead">Set up and use the cliGCP command line interface to interact with LLMs and MCP tools</div>
	<p>This tutorial guides you through setting up and using the cliGCP command line interface to interact with LLMs and MCP tools. By the end, you&rsquo;ll be able to run the CLI and perform basic tasks with it.</p>
<h2 id="prerequisites">Prerequisites<a class="td-heading-self-link" href="#prerequisites" aria-label="Heading self-link"></a></h2>
<ul>
<li>Go &gt;= 1.21 installed on your system</li>
<li>Access to Google Cloud Platform with Vertex AI API enabled</li>
<li>GCP authentication set up via <code>gcloud auth login</code></li>
<li>The gomcptest repository cloned and tools built (see the <a href="../getting-started/">Getting Started</a> guide)</li>
</ul>
<h2 id="step-1-understand-the-cligcp-tool">Step 1: Understand the cliGCP Tool<a class="td-heading-self-link" href="#step-1-understand-the-cligcp-tool" aria-label="Heading self-link"></a></h2>
<p>The cliGCP tool is a command-line interface similar to tools like Claude Code. It connects directly to the Google Cloud Platform&rsquo;s Vertex AI API to access Gemini models and can use local MCP tools to perform actions on your system.</p>
<h2 id="step-2-build-the-cligcp-tool">Step 2: Build the cliGCP Tool<a class="td-heading-self-link" href="#step-2-build-the-cligcp-tool" aria-label="Heading self-link"></a></h2>
<p>First, build the cliGCP tool if you haven&rsquo;t already:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> gomcptest
</span></span><span style="display:flex;"><span>make all  <span style="color:#8f5902;font-style:italic"># This builds all tools including cliGCP</span>
</span></span></code></pre></div><p>If you only want to build cliGCP, you can run:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> host/cliGCP/cmd
</span></span><span style="display:flex;"><span>go build -o ../../../bin/cliGCP
</span></span></code></pre></div><h2 id="step-3-set-up-environment-variables">Step 3: Set Up Environment Variables<a class="td-heading-self-link" href="#step-3-set-up-environment-variables" aria-label="Heading self-link"></a></h2>
<p>The cliGCP tool requires environment variables for GCP configuration. You can set these directly or create an .envrc file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> bin
</span></span><span style="display:flex;"><span>touch .envrc
</span></span></code></pre></div><p>Add the following content to the .envrc file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span>your-gcp-project-id
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_REGION</span><span style="color:#ce5c00;font-weight:bold">=</span>us-central1
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GEMINI_MODELS</span><span style="color:#ce5c00;font-weight:bold">=</span>gemini-2.0-flash
</span></span></code></pre></div><p><strong>Note</strong>: <code>IMAGEN_MODELS</code> and <code>IMAGE_DIR</code> are no longer needed for the cliGCP host. Image generation is available through the independent <code>tools/imagen</code> MCP server.</p>
<p>Load the environment variables:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">source</span> .envrc
</span></span></code></pre></div><h2 id="step-4-run-the-cligcp-tool">Step 4: Run the cliGCP Tool<a class="td-heading-self-link" href="#step-4-run-the-cligcp-tool" aria-label="Heading self-link"></a></h2>
<p>Now you can run the cliGCP tool with MCP tools:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">cd</span> bin
</span></span><span style="display:flex;"><span>./cliGCP -mcpservers <span style="color:#4e9a06">&#34;./GlobTool;./GrepTool;./LS;./View;./dispatch_agent -glob-path ./GlobTool -grep-path ./GrepTool -ls-path ./LS -view-path ./View;./Bash;./Replace&#34;</span>
</span></span></code></pre></div><p>You should see a welcome message and a prompt where you can start interacting with the CLI.</p>
<h2 id="step-5-simple-queries">Step 5: Simple Queries<a class="td-heading-self-link" href="#step-5-simple-queries" aria-label="Heading self-link"></a></h2>
<p>Let&rsquo;s try a few simple interactions:</p>
<pre tabindex="0"><code>&gt; Hello, who are you?
</code></pre><p>You should get a response introducing the agent.</p>
<h2 id="step-6-using-tools">Step 6: Using Tools<a class="td-heading-self-link" href="#step-6-using-tools" aria-label="Heading self-link"></a></h2>
<p>Now let&rsquo;s try using some of the MCP tools:</p>
<pre tabindex="0"><code>&gt; List the files in the current directory
</code></pre><p>The CLI should call the LS tool and show you the files in the current directory.</p>
<pre tabindex="0"><code>&gt; Search for files with &#34;go&#34; in the name
</code></pre><p>The CLI will use the GlobTool to find files matching that pattern.</p>
<pre tabindex="0"><code>&gt; Read the README.md file
</code></pre><p>The CLI will use the View tool to show you the contents of the README.md file.</p>
<h2 id="step-7-creating-a-simple-task">Step 7: Creating a Simple Task<a class="td-heading-self-link" href="#step-7-creating-a-simple-task" aria-label="Heading self-link"></a></h2>
<p>Let&rsquo;s create a simple task that combines multiple tools:</p>
<pre tabindex="0"><code>&gt; Create a new file called test.txt with the text &#34;Hello, world!&#34; and then verify it exists
</code></pre><p>The CLI should:</p>
<ol>
<li>Use the Replace tool to create the file</li>
<li>Use the LS tool to verify the file exists</li>
<li>Use the View tool to show you the contents of the file</li>
</ol>
<h2 id="what-youve-learned">What You&rsquo;ve Learned<a class="td-heading-self-link" href="#what-youve-learned" aria-label="Heading self-link"></a></h2>
<p>In this tutorial, you&rsquo;ve:</p>
<ol>
<li>Set up the cliGCP environment</li>
<li>Run the CLI with MCP tools</li>
<li>Performed basic interactions with the CLI</li>
<li>Used various tools through the CLI to manipulate files</li>
<li>Created a simple workflow combining multiple tools</li>
</ol>
<h2 id="next-steps">Next Steps<a class="td-heading-self-link" href="#next-steps" aria-label="Heading self-link"></a></h2>
<p>Now that you&rsquo;re familiar with the cliGCP tool, you can:</p>
<ul>
<li>Explore more complex tasks that use multiple tools</li>
<li>Try using the dispatch_agent for more complex operations</li>
<li>Create custom tools and use them with the CLI</li>
<li>Experiment with different Gemini models</li>
</ul>
<p>Check out the <a href="../../how-to/configure-cligcp/">How to Configure the cliGCP Tool</a> guide for advanced configuration options.</p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-3ed42a366033a73c16952def2baeb723">2 - How-To Guides</h1>
    <div class="lead">Practical guides for solving specific problems with gomcptest</div>
	

<div class="pageinfo pageinfo-primary">
<p>How-to guides are problem-oriented recipes that guide you through the steps involved in addressing key problems and use cases. They are practical and goal-oriented.</p>

</div>

<p>These guides will help you solve specific tasks and customize gomcptest for your needs.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-1b0984aa513cab2c3fab92be432b3edd">2.1 - How to Create a Custom MCP Tool</h1>
    <div class="lead">Build your own Model Context Protocol (MCP) compatible tools</div>
	<p>This guide shows you how to create a new custom tool that&rsquo;s compatible with the Model Context Protocol (MCP) in gomcptest.</p>
<h2 id="prerequisites">Prerequisites<a class="td-heading-self-link" href="#prerequisites" aria-label="Heading self-link"></a></h2>
<ul>
<li>A working installation of gomcptest</li>
<li>Go programming knowledge</li>
<li>Understanding of the MCP protocol basics</li>
</ul>
<h2 id="steps-to-create-a-custom-tool">Steps to create a custom tool<a class="td-heading-self-link" href="#steps-to-create-a-custom-tool" aria-label="Heading self-link"></a></h2>
<h3 id="1-create-the-tool-directory-structure">1. Create the tool directory structure<a class="td-heading-self-link" href="#1-create-the-tool-directory-structure" aria-label="Heading self-link"></a></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p tools/YourToolName/cmd
</span></span></code></pre></div><h3 id="2-create-the-readmemd-file">2. Create the README.md file<a class="td-heading-self-link" href="#2-create-the-readmemd-file" aria-label="Heading self-link"></a></h3>
<p>Create a <code>README.md</code> in the tool directory with documentation:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>touch tools/YourToolName/README.md
</span></span></code></pre></div><p>Include the following sections:</p>
<ul>
<li>Tool description</li>
<li>Parameters</li>
<li>Usage notes</li>
<li>Example</li>
</ul>
<h3 id="3-create-the-maingo-file">3. Create the main.go file<a class="td-heading-self-link" href="#3-create-the-maingo-file" aria-label="Heading self-link"></a></h3>
<p>Create a <code>main.go</code> file in the cmd directory:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>touch tools/YourToolName/cmd/main.go
</span></span></code></pre></div><h3 id="4-implement-the-tool-functionality">4. Implement the tool functionality<a class="td-heading-self-link" href="#4-implement-the-tool-functionality" aria-label="Heading self-link"></a></h3>
<p>Here&rsquo;s a template to start with:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>	<span style="color:#4e9a06">&#34;encoding/json&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#4e9a06">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#4e9a06">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#4e9a06">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#4e9a06">&#34;github.com/mark3labs/mcp-go&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Define your tool&#39;s parameters structure
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">Params</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Add your parameters here
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// Example:
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">InputParam</span> <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`json:&#34;input_param&#34;`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">server</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">mcp</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">NewServer</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Register your tool function
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">server</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RegisterFunction</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;YourToolName&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">params</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RawMessage</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">any</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">error</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">p</span> <span style="color:#000">Params</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Unmarshal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">params</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">nil</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">fmt</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Errorf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;failed to parse parameters: %w&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#8f5902;font-style:italic">// Implement your tool&#39;s logic here
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>		<span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">doSomethingWithParams</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">result</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">server</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Run</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">os</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Stdin</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">os</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Stdout</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">log</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Fatalf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Server error: %v&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">doSomethingWithParams</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">p</span> <span style="color:#000">Params</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Your tool&#39;s core functionality
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#8f5902;font-style:italic">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Return the result
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#4e9a06">&#34;result&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Your processed result&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="5-add-the-tool-to-the-makefile">5. Add the tool to the Makefile<a class="td-heading-self-link" href="#5-add-the-tool-to-the-makefile" aria-label="Heading self-link"></a></h3>
<p>Open the Makefile in the root directory and add your tool:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#000">YourToolName</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>	go build -o bin/YourToolName tools/YourToolName/cmd/main.go
</span></span></code></pre></div><p>Also add it to the <code>all</code> target.</p>
<h3 id="6-build-your-tool">6. Build your tool<a class="td-heading-self-link" href="#6-build-your-tool" aria-label="Heading self-link"></a></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>make YourToolName
</span></span></code></pre></div><h3 id="7-test-your-tool">7. Test your tool<a class="td-heading-self-link" href="#7-test-your-tool" aria-label="Heading self-link"></a></h3>
<p>Test the tool directly:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#39;{&#34;name&#34;:&#34;YourToolName&#34;,&#34;params&#34;:{&#34;input_param&#34;:&#34;test&#34;}}&#39;</span> <span style="color:#000;font-weight:bold">|</span> ./bin/YourToolName
</span></span></code></pre></div><h3 id="8-use-with-the-cli">8. Use with the CLI<a class="td-heading-self-link" href="#8-use-with-the-cli" aria-label="Heading self-link"></a></h3>
<p>Add your tool to the CLI command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./bin/cliGCP -mcpservers <span style="color:#4e9a06">&#34;./GlobTool;./GrepTool;./LS;./View;./YourToolName;./dispatch_agent;./Bash;./Replace&#34;</span>
</span></span></code></pre></div><h2 id="tips-for-effective-tool-development">Tips for effective tool development<a class="td-heading-self-link" href="#tips-for-effective-tool-development" aria-label="Heading self-link"></a></h2>
<ul>
<li>Focus on a single, well-defined purpose</li>
<li>Provide clear error messages</li>
<li>Include meaningful response formatting</li>
<li>Implement proper parameter validation</li>
<li>Handle edge cases gracefully</li>
<li>Consider adding unit tests in a _test.go file</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-698eac74d7be52f0ac1350e89ad0e597">2.2 - How to Configure the OpenAI-Compatible Server</h1>
    <div class="lead">Customize the OpenAI-compatible server with AgentFlow UI for different use cases, including tool selection, event monitoring, and production deployment</div>
	<p>This guide shows you how to configure and customize the OpenAI-compatible server in gomcptest with the AgentFlow web interface for different use cases.</p>
<h2 id="prerequisites">Prerequisites<a class="td-heading-self-link" href="#prerequisites" aria-label="Heading self-link"></a></h2>
<ul>
<li>A working installation of gomcptest</li>
<li>Basic familiarity with the OpenAI server from the tutorial</li>
<li>Understanding of environment variables and configuration</li>
</ul>
<h2 id="environment-variables-configuration">Environment Variables Configuration<a class="td-heading-self-link" href="#environment-variables-configuration" aria-label="Heading self-link"></a></h2>
<h3 id="basic-server-configuration">Basic Server Configuration<a class="td-heading-self-link" href="#basic-server-configuration" aria-label="Heading self-link"></a></h3>
<p>The OpenAI server can be configured using the following environment variables:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Server port (default: 8080)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">PORT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">8080</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Log level: DEBUG, INFO, WARN, ERROR (default: INFO)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">LOG_LEVEL</span><span style="color:#ce5c00;font-weight:bold">=</span>INFO
</span></span></code></pre></div><h3 id="gcp-configuration">GCP Configuration<a class="td-heading-self-link" href="#gcp-configuration" aria-label="Heading self-link"></a></h3>
<p>Configure the Google Cloud Platform integration:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># GCP Project ID (required)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span>your-gcp-project-id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># GCP Region (default: us-central1)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_REGION</span><span style="color:#ce5c00;font-weight:bold">=</span>us-central1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Comma-separated list of Gemini models (default: gemini-1.5-pro,gemini-2.0-flash)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GEMINI_MODELS</span><span style="color:#ce5c00;font-weight:bold">=</span>gemini-1.5-pro,gemini-2.0-flash
</span></span></code></pre></div><p><strong>Note</strong>: <code>IMAGEN_MODELS</code> and <code>IMAGE_DIR</code> environment variables are no longer needed for the openaiserver. Image generation is now handled by the independent <code>tools/imagen</code> MCP server.</p>
<h3 id="vertex-ai-tools-configuration">Vertex AI Tools Configuration<a class="td-heading-self-link" href="#vertex-ai-tools-configuration" aria-label="Heading self-link"></a></h3>
<p>Enable additional Vertex AI built-in tools:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Enable code execution capabilities</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">VERTEX_AI_CODE_EXECUTION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Enable Google Search integration</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">VERTEX_AI_GOOGLE_SEARCH</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Enable Google Search with retrieval and grounding</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">VERTEX_AI_GOOGLE_SEARCH_RETRIEVAL</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87">true</span>
</span></span></code></pre></div><h2 id="agentflow-ui-configuration">AgentFlow UI Configuration<a class="td-heading-self-link" href="#agentflow-ui-configuration" aria-label="Heading self-link"></a></h2>
<p>The AgentFlow web interface provides several configuration options for enhanced user experience.</p>
<h3 id="accessing-agentflow">Accessing AgentFlow<a class="td-heading-self-link" href="#accessing-agentflow" aria-label="Heading self-link"></a></h3>
<p>Once your server is running, access AgentFlow at:</p>
<pre tabindex="0"><code>http://localhost:8080/ui
</code></pre><h3 id="tool-selection-configuration">Tool Selection Configuration<a class="td-heading-self-link" href="#tool-selection-configuration" aria-label="Heading self-link"></a></h3>
<p>AgentFlow allows granular control over tool availability:</p>
<ol>
<li><strong>Default Behavior</strong>: All tools are available by default</li>
<li><strong>Tool Filtering</strong>: Use the tool selection dropdown to choose specific tools</li>
<li><strong>Model String Format</strong>: Selected tools are encoded as <code>model|tool1|tool2|tool3</code></li>
</ol>
<p>Example tool selection scenarios:</p>
<ul>
<li><strong>Development</strong>: Enable only <code>Edit</code>, <code>View</code>, <code>GlobTool</code>, and <code>GrepTool</code> for code editing tasks</li>
<li><strong>File Management</strong>: Enable only <code>LS</code>, <code>View</code>, <code>Bash</code> for system administration</li>
<li><strong>Content Creation</strong>: Enable <code>View</code>, <code>Replace</code>, <code>Edit</code> for document editing</li>
</ul>
<h3 id="event-monitoring-configuration">Event Monitoring Configuration<a class="td-heading-self-link" href="#event-monitoring-configuration" aria-label="Heading self-link"></a></h3>
<p>AgentFlow provides real-time tool event monitoring:</p>
<ul>
<li><strong>Tool Call Events</strong>: See when AI decides to use tools</li>
<li><strong>Tool Response Events</strong>: Monitor tool execution results</li>
<li><strong>Event Persistence</strong>: All events are saved in conversation history</li>
<li><strong>Event Details</strong>: Click notifications for detailed argument/response information</li>
</ul>
<h3 id="mobile-and-pwa-configuration">Mobile and PWA Configuration<a class="td-heading-self-link" href="#mobile-and-pwa-configuration" aria-label="Heading self-link"></a></h3>
<p>For mobile deployment, AgentFlow supports Progressive Web App features:</p>
<ol>
<li><strong>Apple Touch Icons</strong>: Pre-configured for iOS web app installation</li>
<li><strong>Responsive Design</strong>: Optimized for mobile devices</li>
<li><strong>Web App Manifest</strong>: Supports &ldquo;Add to Home Screen&rdquo; functionality</li>
<li><strong>Offline Capability</strong>: Conversations persist offline</li>
</ol>
<h3 id="ui-customization">UI Customization<a class="td-heading-self-link" href="#ui-customization" aria-label="Heading self-link"></a></h3>
<p>You can customize AgentFlow by modifying the template file:</p>
<pre tabindex="0"><code>host/openaiserver/simpleui/chat-ui.html.tmpl
</code></pre><p>Key customization areas:</p>
<ul>
<li><strong>Color Scheme</strong>: Modify CSS gradient backgrounds</li>
<li><strong>Tool Notification Styling</strong>: Customize event notification appearance</li>
<li><strong>Mobile Behavior</strong>: Adjust responsive breakpoints</li>
<li><strong>Branding</strong>: Update titles, icons, and metadata</li>
</ul>
<h3 id="setting-up-a-production-environment">Setting Up a Production Environment<a class="td-heading-self-link" href="#setting-up-a-production-environment" aria-label="Heading self-link"></a></h3>
<p>For a production environment, create a proper systemd service file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nano /etc/systemd/system/gomcptest-openai.service
</span></span></code></pre></div><p>Add the following content:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">[Unit]</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">Description</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">gomcptest OpenAI Server</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">After</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">network.target</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">[Service]</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">User</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">yourusername</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">WorkingDirectory</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">/path/to/gomcptest/host/openaiserver</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">ExecStart</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">/path/to/gomcptest/host/openaiserver/openaiserver -mcpservers &#34;/path/to/gomcptest/bin/GlobTool;/path/to/gomcptest/bin/GrepTool;/path/to/gomcptest/bin/LS;/path/to/gomcptest/bin/View;/path/to/gomcptest/bin/Bash;/path/to/gomcptest/bin/Replace&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">Environment</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">PORT=8080</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">Environment</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">LOG_LEVEL=INFO</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">Environment</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">GCP_PROJECT=your-gcp-project-id</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">Environment</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">GCP_REGION=us-central1</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">Environment</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">GEMINI_MODELS=gemini-1.5-pro,gemini-2.0-flash</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">Restart</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">on-failure</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">[Install]</span>
</span></span><span style="display:flex;"><span><span style="color:#c4a000">WantedBy</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">multi-user.target</span>
</span></span></code></pre></div><p>Then enable and start the service:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl <span style="color:#204a87">enable</span> gomcptest-openai
</span></span><span style="display:flex;"><span>sudo systemctl start gomcptest-openai
</span></span></code></pre></div><h2 id="configuring-mcp-tools">Configuring MCP Tools<a class="td-heading-self-link" href="#configuring-mcp-tools" aria-label="Heading self-link"></a></h2>
<h3 id="adding-custom-tools">Adding Custom Tools<a class="td-heading-self-link" href="#adding-custom-tools" aria-label="Heading self-link"></a></h3>
<p>To add custom MCP tools to the server, include them in the <code>-mcpservers</code> parameter when starting the server:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go run . -mcpservers <span style="color:#4e9a06">&#34;../bin/GlobTool;../bin/GrepTool;../bin/LS;../bin/View;../bin/YourCustomTool;../bin/Bash;../bin/Replace&#34;</span>
</span></span></code></pre></div><h3 id="tool-parameters-and-arguments">Tool Parameters and Arguments<a class="td-heading-self-link" href="#tool-parameters-and-arguments" aria-label="Heading self-link"></a></h3>
<p>Some tools require additional parameters. You can specify these after the tool path:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>go run . -mcpservers <span style="color:#4e9a06">&#34;../bin/GlobTool;../bin/dispatch_agent -glob-path ../bin/GlobTool -grep-path ../bin/GrepTool -ls-path ../bin/LS -view-path ../bin/View&#34;</span>
</span></span></code></pre></div><h2 id="api-usage-configuration">API Usage Configuration<a class="td-heading-self-link" href="#api-usage-configuration" aria-label="Heading self-link"></a></h2>
<h3 id="enabling-cors">Enabling CORS<a class="td-heading-self-link" href="#enabling-cors" aria-label="Heading self-link"></a></h3>
<p>For web applications, you may need to enable CORS. Add a middleware to the main.go file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// other imports
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// CORS middleware
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">corsMiddleware</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">next</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Handler</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Handler</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">HandlerFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ResponseWriter</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Request</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Access-Control-Allow-Origin&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;*&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Access-Control-Allow-Methods&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;GET, POST, OPTIONS&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Access-Control-Allow-Headers&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Content-Type, Authorization&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Method</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;OPTIONS&#34;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WriteHeader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">StatusOK</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#000">next</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ServeHTTP</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// existing code...
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Handle</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">corsMiddleware</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">openAIHandler</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// existing code...
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="setting-rate-limits">Setting Rate Limits<a class="td-heading-self-link" href="#setting-rate-limits" aria-label="Heading self-link"></a></h3>
<p>Add a simple rate limiting middleware:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;sync&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// other imports
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">RateLimiter</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">requests</span>     <span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">][]</span><span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Time</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">maxRequests</span>  <span style="color:#204a87;font-weight:bold">int</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">timeWindow</span>   <span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Duration</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">mu</span>           <span style="color:#000">sync</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Mutex</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">NewRateLimiter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">maxRequests</span> <span style="color:#204a87;font-weight:bold">int</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">timeWindow</span> <span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Duration</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">RateLimiter</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">RateLimiter</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">requests</span><span style="color:#000;font-weight:bold">:</span>    <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">][]</span><span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Time</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">maxRequests</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">maxRequests</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">timeWindow</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000">timeWindow</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">rl</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">RateLimiter</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">Middleware</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">next</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Handler</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Handler</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">HandlerFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ResponseWriter</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Request</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">ip</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">RemoteAddr</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">mu</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Lock</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Clean up old requests
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">now</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Now</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">reqs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">exists</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">requests</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">ip</span><span style="color:#000;font-weight:bold">];</span> <span style="color:#000">exists</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">validReqs</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Time</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">req</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">reqs</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">now</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Sub</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">req</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">timeWindow</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">validReqs</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">validReqs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">req</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">requests</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">ip</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">validReqs</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Check if rate limit is exceeded
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">requests</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">ip</span><span style="color:#000;font-weight:bold">])</span> <span style="color:#ce5c00;font-weight:bold">&gt;=</span> <span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">maxRequests</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">mu</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Unlock</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Error</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Rate limit exceeded&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">StatusTooManyRequests</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Add current request
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">requests</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">ip</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">requests</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">ip</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">now</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">rl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">mu</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Unlock</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#000">next</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ServeHTTP</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// existing code...
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">rateLimiter</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">NewRateLimiter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">10</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Minute</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic">// 10 requests per minute
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Handle</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;/&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rateLimiter</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Middleware</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">corsMiddleware</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">openAIHandler</span><span style="color:#000;font-weight:bold">)))</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// existing code...
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="performance-tuning">Performance Tuning<a class="td-heading-self-link" href="#performance-tuning" aria-label="Heading self-link"></a></h2>
<h3 id="adjusting-memory-usage">Adjusting Memory Usage<a class="td-heading-self-link" href="#adjusting-memory-usage" aria-label="Heading self-link"></a></h3>
<p>For high-load scenarios, adjust Go&rsquo;s garbage collector:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GOGC</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">100</span>  <span style="color:#8f5902;font-style:italic"># Default is 100, lower values lead to more frequent GC</span>
</span></span></code></pre></div><h3 id="increasing-concurrency">Increasing Concurrency<a class="td-heading-self-link" href="#increasing-concurrency" aria-label="Heading self-link"></a></h3>
<p>If handling many concurrent requests, adjust the server&rsquo;s concurrency limits:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// other imports
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// existing code...
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">server</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Server</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Addr</span><span style="color:#000;font-weight:bold">:</span>         <span style="color:#4e9a06">&#34;:&#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">strconv</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Itoa</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">cfg</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Port</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Handler</span><span style="color:#000;font-weight:bold">:</span>      <span style="color:#000">openAIHandler</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">ReadTimeout</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#0000cf;font-weight:bold">30</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Second</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">WriteTimeout</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">120</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Second</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">IdleTimeout</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#0000cf;font-weight:bold">120</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">time</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Second</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">MaxHeaderBytes</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#ce5c00;font-weight:bold">&lt;&lt;</span> <span style="color:#0000cf;font-weight:bold">20</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">err</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000">server</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ListenAndServe</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// existing code...
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="troubleshooting-common-issues">Troubleshooting Common Issues<a class="td-heading-self-link" href="#troubleshooting-common-issues" aria-label="Heading self-link"></a></h2>
<h3 id="debugging-connection-problems">Debugging Connection Problems<a class="td-heading-self-link" href="#debugging-connection-problems" aria-label="Heading self-link"></a></h3>
<p>If you&rsquo;re experiencing connection issues, set the log level to DEBUG:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">LOG_LEVEL</span><span style="color:#ce5c00;font-weight:bold">=</span>DEBUG
</span></span></code></pre></div><h3 id="common-error-messages">Common Error Messages<a class="td-heading-self-link" href="#common-error-messages" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>Failed to create MCP client</strong>: Ensure the tool path is correct and the tool is executable</li>
<li><strong>Failed to load GCP config</strong>: Check your GCP environment variables</li>
<li><strong>Error in LLM request</strong>: Verify your GCP credentials and project access</li>
</ul>
<h3 id="checking-tool-registration">Checking Tool Registration<a class="td-heading-self-link" href="#checking-tool-registration" aria-label="Heading self-link"></a></h3>
<p>To verify tools are registered correctly, look for log messages like:</p>
<pre tabindex="0"><code>INFO server0 Registering command=../bin/GlobTool
INFO server1 Registering command=../bin/GrepTool
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-0593b1249420a69082646ae587a17e4e">2.3 - How to Configure the cliGCP Command Line Interface</h1>
    <div class="lead">Customize the cliGCP tool with environment variables and command-line options</div>
	<p>This guide shows you how to configure and customize the cliGCP command line interface for various use cases.</p>
<h2 id="prerequisites">Prerequisites<a class="td-heading-self-link" href="#prerequisites" aria-label="Heading self-link"></a></h2>
<ul>
<li>A working installation of gomcptest</li>
<li>Basic familiarity with the cliGCP tool from the tutorial</li>
<li>Understanding of environment variables and configuration</li>
</ul>
<h2 id="command-line-arguments">Command Line Arguments<a class="td-heading-self-link" href="#command-line-arguments" aria-label="Heading self-link"></a></h2>
<p>The cliGCP tool accepts the following command line arguments:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Specify the MCP servers to use (required)</span>
</span></span><span style="display:flex;"><span>-mcpservers <span style="color:#4e9a06">&#34;tool1;tool2;tool3&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Example with tool arguments</span>
</span></span><span style="display:flex;"><span>./cliGCP -mcpservers <span style="color:#4e9a06">&#34;./GlobTool;./GrepTool;./dispatch_agent -glob-path ./GlobTool -grep-path ./GrepTool -ls-path ./LS -view-path ./View;./Bash&#34;</span>
</span></span></code></pre></div><h2 id="environment-variables-configuration">Environment Variables Configuration<a class="td-heading-self-link" href="#environment-variables-configuration" aria-label="Heading self-link"></a></h2>
<h3 id="gcp-configuration">GCP Configuration<a class="td-heading-self-link" href="#gcp-configuration" aria-label="Heading self-link"></a></h3>
<p>Configure the Google Cloud Platform integration with these environment variables:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># GCP Project ID (required)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span>your-gcp-project-id
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># GCP Region (default: us-central1)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_REGION</span><span style="color:#ce5c00;font-weight:bold">=</span>us-central1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Comma-separated list of Gemini models (required)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GEMINI_MODELS</span><span style="color:#ce5c00;font-weight:bold">=</span>gemini-1.5-pro,gemini-2.0-flash
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Directory to store images (required for image generation)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">IMAGE_DIR</span><span style="color:#ce5c00;font-weight:bold">=</span>/path/to/image/directory
</span></span></code></pre></div><h3 id="advanced-configuration">Advanced Configuration<a class="td-heading-self-link" href="#advanced-configuration" aria-label="Heading self-link"></a></h3>
<p>You can customize the behavior of the cliGCP tool with these additional environment variables:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Set a custom system instruction for the model</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">SYSTEM_INSTRUCTION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;You are a helpful assistant specialized in Go programming.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Adjust the model&#39;s temperature (0.0-1.0, default is 0.2)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Lower values make output more deterministic, higher values more creative</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">MODEL_TEMPERATURE</span><span style="color:#ce5c00;font-weight:bold">=</span>0.3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Set a maximum token limit for responses</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">MAX_OUTPUT_TOKENS</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2048</span>
</span></span></code></pre></div><h2 id="creating-shell-aliases">Creating Shell Aliases<a class="td-heading-self-link" href="#creating-shell-aliases" aria-label="Heading self-link"></a></h2>
<p>To simplify usage, create shell aliases in your <code>.bashrc</code> or <code>.zshrc</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Add to ~/.bashrc or ~/.zshrc</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">alias</span> <span style="color:#000">gpt</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;cd /path/to/gomcptest/bin &amp;&amp; ./cliGCP -mcpservers &#34;./GlobTool;./GrepTool;./LS;./View;./Bash;./Replace&#34;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Create specialized aliases for different tasks</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">alias</span> code-assistant<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;cd /path/to/gomcptest/bin &amp;&amp; GCP_PROJECT=your-project GEMINI_MODELS=gemini-2.0-flash ./cliGCP -mcpservers &#34;./GlobTool;./GrepTool;./LS;./View;./Bash;./Replace&#34;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">alias</span> security-scanner<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;cd /path/to/gomcptest/bin &amp;&amp; SYSTEM_INSTRUCTION=&#34;You are a security expert focused on finding vulnerabilities in code&#34; ./cliGCP -mcpservers &#34;./GlobTool;./GrepTool;./LS;./View;./Bash&#34;&#39;</span>
</span></span></code></pre></div><h2 id="customizing-the-system-instruction">Customizing the System Instruction<a class="td-heading-self-link" href="#customizing-the-system-instruction" aria-label="Heading self-link"></a></h2>
<p>To modify the default system instruction, edit the <code>agent.go</code> file:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// In host/cliGCP/cmd/agent.go
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">genaimodels</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">model</span><span style="color:#000;font-weight:bold">].</span><span style="color:#000">SystemInstruction</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Content</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Role</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Parts</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Part</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Text</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;You are a helpful agent with access to tools. &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;Your job is to help the user by performing tasks using these tools. &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;You should not make up information. &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;If you don&#39;t know something, say so and explain what you would need to know to help. &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#4e9a06">&#34;If not indication, use the current working directory which is &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">cwd</span><span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="creating-task-specific-configurations">Creating Task-Specific Configurations<a class="td-heading-self-link" href="#creating-task-specific-configurations" aria-label="Heading self-link"></a></h2>
<p>For different use cases, you can create specialized configuration scripts:</p>
<h3 id="code-review-helper">Code Review Helper<a class="td-heading-self-link" href="#code-review-helper" aria-label="Heading self-link"></a></h3>
<p>Create a file called <code>code-reviewer.sh</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span>your-gcp-project-id
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_REGION</span><span style="color:#ce5c00;font-weight:bold">=</span>us-central1
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GEMINI_MODELS</span><span style="color:#ce5c00;font-weight:bold">=</span>gemini-2.0-flash
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">IMAGE_DIR</span><span style="color:#ce5c00;font-weight:bold">=</span>/tmp/images
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">SYSTEM_INSTRUCTION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;You are a code review expert. Analyze code for bugs, security issues, and areas for improvement. Focus on providing constructive feedback and detailed explanations.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> /path/to/gomcptest/bin
</span></span><span style="display:flex;"><span>./cliGCP -mcpservers <span style="color:#4e9a06">&#34;./GlobTool;./GrepTool;./LS;./View;./Bash&#34;</span>
</span></span></code></pre></div><p>Make it executable:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chmod +x code-reviewer.sh
</span></span></code></pre></div><h3 id="documentation-generator">Documentation Generator<a class="td-heading-self-link" href="#documentation-generator" aria-label="Heading self-link"></a></h3>
<p>Create a file called <code>doc-generator.sh</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span>your-gcp-project-id
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_REGION</span><span style="color:#ce5c00;font-weight:bold">=</span>us-central1
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GEMINI_MODELS</span><span style="color:#ce5c00;font-weight:bold">=</span>gemini-2.0-flash
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">IMAGE_DIR</span><span style="color:#ce5c00;font-weight:bold">=</span>/tmp/images
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">SYSTEM_INSTRUCTION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;You are a documentation specialist. Your task is to help create clear, comprehensive documentation for code. Analyze code structure and create appropriate documentation following best practices.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> /path/to/gomcptest/bin
</span></span><span style="display:flex;"><span>./cliGCP -mcpservers <span style="color:#4e9a06">&#34;./GlobTool;./GrepTool;./LS;./View;./Bash;./Replace&#34;</span>
</span></span></code></pre></div><h2 id="advanced-tool-configurations">Advanced Tool Configurations<a class="td-heading-self-link" href="#advanced-tool-configurations" aria-label="Heading self-link"></a></h2>
<h3 id="configuring-dispatch_agent">Configuring dispatch_agent<a class="td-heading-self-link" href="#configuring-dispatch_agent" aria-label="Heading self-link"></a></h3>
<p>When using the dispatch_agent tool, you can configure its behavior with additional arguments:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./cliGCP -mcpservers <span style="color:#4e9a06">&#34;./GlobTool;./GrepTool;./LS;./View;./dispatch_agent -glob-path ./GlobTool -grep-path ./GrepTool -ls-path ./LS -view-path ./View -timeout 30s;./Bash;./Replace&#34;</span>
</span></span></code></pre></div><h3 id="creating-tool-combinations">Creating Tool Combinations<a class="td-heading-self-link" href="#creating-tool-combinations" aria-label="Heading self-link"></a></h3>
<p>You can create specialized tool combinations for different tasks:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Web development toolset</span>
</span></span><span style="display:flex;"><span>./cliGCP -mcpservers <span style="color:#4e9a06">&#34;./GlobTool -include &#39;*.{html,css,js}&#39;;./GrepTool;./LS;./View;./Bash;./Replace&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Go development toolset</span>
</span></span><span style="display:flex;"><span>./cliGCP -mcpservers <span style="color:#4e9a06">&#34;./GlobTool -include &#39;*.go&#39;;./GrepTool;./LS;./View;./Bash;./Replace&#34;</span>
</span></span></code></pre></div><h2 id="troubleshooting-common-issues">Troubleshooting Common Issues<a class="td-heading-self-link" href="#troubleshooting-common-issues" aria-label="Heading self-link"></a></h2>
<h3 id="model-connection-issues">Model Connection Issues<a class="td-heading-self-link" href="#model-connection-issues" aria-label="Heading self-link"></a></h3>
<p>If you&rsquo;re having trouble connecting to the Gemini model:</p>
<ol>
<li>Verify your GCP credentials:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud auth application-default print-access-token
</span></span></code></pre></div><ol start="2">
<li>Check that the Vertex AI API is enabled:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gcloud services list --enabled <span style="color:#000;font-weight:bold">|</span> grep aiplatform
</span></span></code></pre></div><ol start="3">
<li>Verify your project has access to the models you&rsquo;re requesting</li>
</ol>
<h3 id="tool-execution-failures">Tool Execution Failures<a class="td-heading-self-link" href="#tool-execution-failures" aria-label="Heading self-link"></a></h3>
<p>If tools are failing to execute:</p>
<ol>
<li>Ensure the tool paths are correct</li>
<li>Verify the tools are executable</li>
<li>Check for permission issues in the directories you&rsquo;re accessing</li>
</ol>
<h3 id="performance-optimization">Performance Optimization<a class="td-heading-self-link" href="#performance-optimization" aria-label="Heading self-link"></a></h3>
<p>For better performance:</p>
<ol>
<li>Use more specific tool patterns to reduce search scope</li>
<li>Consider creating specialized agents for different tasks</li>
<li>Set a lower temperature for more deterministic responses</li>
</ol>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ae5e1f7351270a62eef2bc0be0c0f670">2.4 - How to Use the OpenAI Server with big-AGI</h1>
    <div class="lead">Configure the gomcptest OpenAI-compatible server as a backend for big-AGI</div>
	<p>This guide shows you how to set up and configure the gomcptest OpenAI-compatible server to work with <a href="https://github.com/enricoros/big-agi">big-AGI</a>, a popular open-source web client for AI assistants.</p>
<h2 id="prerequisites">Prerequisites<a class="td-heading-self-link" href="#prerequisites" aria-label="Heading self-link"></a></h2>
<ul>
<li>A working installation of gomcptest</li>
<li>The OpenAI-compatible server running (see the <a href="../../tutorials/openaiserver-tutorial/">OpenAI Server tutorial</a>)</li>
<li><a href="https://nodejs.org/">Node.js</a> (version 18.17.0 or newer)</li>
<li>Git</li>
</ul>
<h2 id="why-use-big-agi-with-gomcptest">Why Use big-AGI with gomcptest?<a class="td-heading-self-link" href="#why-use-big-agi-with-gomcptest" aria-label="Heading self-link"></a></h2>
<p>big-AGI provides a polished, feature-rich web interface for interacting with AI models. By connecting it to the gomcptest OpenAI-compatible server, you get:</p>
<ul>
<li>A professional web interface for your AI interactions</li>
<li>Support for tools/function calling</li>
<li>Conversation history management</li>
<li>Persona management</li>
<li>Image generation capabilities</li>
<li>Multiple user support</li>
</ul>
<h2 id="setting-up-big-agi">Setting Up big-AGI<a class="td-heading-self-link" href="#setting-up-big-agi" aria-label="Heading self-link"></a></h2>
<ol>
<li>
<p><strong>Clone the big-AGI repository</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/enricoros/big-agi.git
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> big-agi
</span></span></code></pre></div></li>
<li>
<p><strong>Install dependencies</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install
</span></span></code></pre></div></li>
<li>
<p><strong>Create a <code>.env.local</code> file</strong> for configuration:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cp .env.example .env.local
</span></span></code></pre></div></li>
<li>
<p><strong>Edit the <code>.env.local</code> file</strong> to configure your gomcptest server connection:</p>
<pre tabindex="0"><code># big-AGI configuration

# Your gomcptest OpenAI-compatible server URL
OPENAI_API_HOST=http://localhost:8080

# This can be any string since the gomcptest server doesn&#39;t use API keys
OPENAI_API_KEY=gomcptest-local-server

# Set this to true to enable the custom server
OPENAI_API_ENABLE_CUSTOM_PROVIDER=true
</code></pre></li>
<li>
<p><strong>Start big-AGI</strong>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm run dev
</span></span></code></pre></div></li>
<li>
<p>Open your browser and navigate to <code>http://localhost:3000</code> to access the big-AGI interface.</p>
</li>
</ol>
<h2 id="configuring-big-agi-to-use-your-models">Configuring big-AGI to Use Your Models<a class="td-heading-self-link" href="#configuring-big-agi-to-use-your-models" aria-label="Heading self-link"></a></h2>
<p>The gomcptest OpenAI-compatible server exposes Google Cloud models through an OpenAI-compatible API. In big-AGI, you&rsquo;ll need to configure the models:</p>
<ol>
<li>Open big-AGI in your browser</li>
<li>Click on the <strong>Settings</strong> icon (gear) in the top right</li>
<li>Go to the <strong>Models</strong> tab</li>
<li>Under &ldquo;OpenAI Models&rdquo;:
<ul>
<li>Click &ldquo;Add Models&rdquo;</li>
<li>Add your models by ID (e.g., <code>gemini-1.5-pro</code>, <code>gemini-2.0-flash</code>)</li>
<li>Set context length appropriately (8K-32K depending on the model)</li>
<li>Set function calling capability to <code>true</code> for models that support it</li>
</ul>
</li>
</ol>
<h2 id="enabling-function-calling-with-tools">Enabling Function Calling with Tools<a class="td-heading-self-link" href="#enabling-function-calling-with-tools" aria-label="Heading self-link"></a></h2>
<p>To use the MCP tools through big-AGI&rsquo;s function calling interface:</p>
<ol>
<li>In big-AGI, click on the <strong>Settings</strong> icon</li>
<li>Go to the <strong>Advanced</strong> tab</li>
<li>Enable &ldquo;Function Calling&rdquo; under the &ldquo;Experimental Features&rdquo; section</li>
<li>In a new chat, click on the &ldquo;Functions&rdquo; tab (plugin icon) in the chat interface</li>
<li>The available tools from your gomcptest server should be listed</li>
</ol>
<h2 id="configuring-cors-for-big-agi">Configuring CORS for big-AGI<a class="td-heading-self-link" href="#configuring-cors-for-big-agi" aria-label="Heading self-link"></a></h2>
<p>If you&rsquo;re running big-AGI on a different domain or port than your gomcptest server, you&rsquo;ll need to enable CORS on the server side. Edit the OpenAI server configuration:</p>
<ol>
<li>
<p>Create or edit a CORS middleware for the OpenAI server:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// CORS middleware with specific origin allowance
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">corsMiddleware</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">next</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Handler</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Handler</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">HandlerFunc</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ResponseWriter</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Request</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Allow requests from big-AGI origin
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Access-Control-Allow-Origin&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;http://localhost:3000&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Access-Control-Allow-Methods&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;GET, POST, OPTIONS&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Access-Control-Allow-Headers&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Content-Type, Authorization&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Method</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;OPTIONS&#34;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">WriteHeader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">StatusOK</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">return</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">next</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ServeHTTP</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div></li>
<li>
<p>Apply this middleware to your server routes</p>
</li>
</ol>
<h2 id="troubleshooting-common-issues">Troubleshooting Common Issues<a class="td-heading-self-link" href="#troubleshooting-common-issues" aria-label="Heading self-link"></a></h2>
<h3 id="model-not-found">Model Not Found<a class="td-heading-self-link" href="#model-not-found" aria-label="Heading self-link"></a></h3>
<p>If big-AGI reports that models cannot be found:</p>
<ol>
<li>Verify your gomcptest server is running and accessible</li>
<li>Check the server logs to ensure models are properly registered</li>
<li>Make sure the model IDs in big-AGI match exactly the ones provided by your gomcptest server</li>
</ol>
<h3 id="function-calling-not-working">Function Calling Not Working<a class="td-heading-self-link" href="#function-calling-not-working" aria-label="Heading self-link"></a></h3>
<p>If tools aren&rsquo;t working properly:</p>
<ol>
<li>Ensure the tools are properly registered in your gomcptest server</li>
<li>Check that function calling is enabled in big-AGI settings</li>
<li>Verify the model you&rsquo;re using supports function calling</li>
</ol>
<h3 id="connection-issues">Connection Issues<a class="td-heading-self-link" href="#connection-issues" aria-label="Heading self-link"></a></h3>
<p>If big-AGI can&rsquo;t connect to your server:</p>
<ol>
<li>Verify the <code>OPENAI_API_HOST</code> value in your <code>.env.local</code> file</li>
<li>Check for CORS issues in your browser&rsquo;s developer console</li>
<li>Ensure your server is running and accessible from the browser</li>
</ol>
<h2 id="production-deployment">Production Deployment<a class="td-heading-self-link" href="#production-deployment" aria-label="Heading self-link"></a></h2>
<p>For production use, consider:</p>
<ol>
<li>
<p><strong>Securing your API</strong>:</p>
<ul>
<li>Add proper authentication to your gomcptest OpenAI server</li>
<li>Update the <code>OPENAI_API_KEY</code> in big-AGI accordingly</li>
</ul>
</li>
<li>
<p><strong>Deploying big-AGI</strong>:</p>
<ul>
<li>Follow the <a href="https://github.com/enricoros/big-agi/blob/main/docs/deployment.md">big-AGI deployment guide</a></li>
<li>Configure the environment variables to point to your production gomcptest server</li>
</ul>
</li>
<li>
<p><strong>Setting up HTTPS</strong>:</p>
<ul>
<li>For production, both big-AGI and your gomcptest server should use HTTPS</li>
<li>Consider using a reverse proxy like Nginx with Let&rsquo;s Encrypt certificates</li>
</ul>
</li>
</ol>
<h2 id="example-basic-chat-interface">Example: Basic Chat Interface<a class="td-heading-self-link" href="#example-basic-chat-interface" aria-label="Heading self-link"></a></h2>
<p>Once everything is set up, you can use big-AGI&rsquo;s interface to interact with your AI models:</p>
<ol>
<li>Start a new chat</li>
<li>Select your model from the model dropdown (e.g., <code>gemini-1.5-pro</code>)</li>
<li>Enable function calling if you want to use tools</li>
<li>Begin chatting with your AI assistant, powered by gomcptest</li>
</ol>
<p>The big-AGI interface provides a much richer experience than a command-line interface, with features like conversation history, markdown rendering, code highlighting, and more.</p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b00a88a07ceb21b1a83e5822e0c86c1d">3 - Reference</h1>
    <div class="lead">Technical reference documentation for gomcptest components and tools</div>
	

<div class="pageinfo pageinfo-primary">
<p>Reference guides are technical descriptions of the machinery and how to operate it. They describe how things work in detail and are accurate and complete.</p>

</div>

<p>This section provides detailed technical documentation on gomcptest&rsquo;s components, APIs, parameters, and tools.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-4f002b9458521ca7afd32176fd590646">3.1 - Tools Reference</h1>
    <div class="lead">Comprehensive reference of all available MCP-compatible tools</div>
	

<div class="pageinfo pageinfo-primary">
<p>This reference guide documents all available MCP-compatible tools in the gomcptest project, their parameters, and response formats.</p>

</div>

<h2 id="bash">Bash<a class="td-heading-self-link" href="#bash" aria-label="Heading self-link"></a></h2>
<p>Executes bash commands in a persistent shell session.</p>
<h3 id="parameters">Parameters<a class="td-heading-self-link" href="#parameters" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>command</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>The command to execute</td>
      </tr>
      <tr>
          <td><code>timeout</code></td>
          <td>number</td>
          <td>No</td>
          <td>Timeout in milliseconds (max 600000)</td>
      </tr>
  </tbody>
</table>
<h3 id="response">Response<a class="td-heading-self-link" href="#response" aria-label="Heading self-link"></a></h3>
<p>The tool returns the command output as a string.</p>
<h3 id="banned-commands">Banned Commands<a class="td-heading-self-link" href="#banned-commands" aria-label="Heading self-link"></a></h3>
<p>For security reasons, the following commands are banned:
<code>alias</code>, <code>curl</code>, <code>curlie</code>, <code>wget</code>, <code>axel</code>, <code>aria2c</code>, <code>nc</code>, <code>telnet</code>, <code>lynx</code>, <code>w3m</code>, <code>links</code>, <code>httpie</code>, <code>xh</code>, <code>http-prompt</code>, <code>chrome</code>, <code>firefox</code>, <code>safari</code></p>
<h2 id="edit">Edit<a class="td-heading-self-link" href="#edit" aria-label="Heading self-link"></a></h2>
<p>Modifies file content by replacing specified text.</p>
<h3 id="parameters-1">Parameters<a class="td-heading-self-link" href="#parameters-1" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>file_path</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Absolute path to the file to modify</td>
      </tr>
      <tr>
          <td><code>old_string</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Text to replace</td>
      </tr>
      <tr>
          <td><code>new_string</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Replacement text</td>
      </tr>
  </tbody>
</table>
<h3 id="response-1">Response<a class="td-heading-self-link" href="#response-1" aria-label="Heading self-link"></a></h3>
<p>Confirmation message with the updated content.</p>
<h2 id="globtool">GlobTool<a class="td-heading-self-link" href="#globtool" aria-label="Heading self-link"></a></h2>
<p>Finds files matching glob patterns with metadata.</p>
<h3 id="parameters-2">Parameters<a class="td-heading-self-link" href="#parameters-2" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>pattern</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Glob pattern to match files against</td>
      </tr>
      <tr>
          <td><code>path</code></td>
          <td>string</td>
          <td>No</td>
          <td>Directory to search in (default: current directory)</td>
      </tr>
      <tr>
          <td><code>exclude</code></td>
          <td>string</td>
          <td>No</td>
          <td>Glob pattern to exclude from results</td>
      </tr>
      <tr>
          <td><code>limit</code></td>
          <td>number</td>
          <td>No</td>
          <td>Maximum number of results to return</td>
      </tr>
      <tr>
          <td><code>absolute</code></td>
          <td>boolean</td>
          <td>No</td>
          <td>Return absolute paths instead of relative</td>
      </tr>
  </tbody>
</table>
<h3 id="response-2">Response<a class="td-heading-self-link" href="#response-2" aria-label="Heading self-link"></a></h3>
<p>A list of matching files with metadata including path, size, modification time, and permissions.</p>
<h2 id="greptool">GrepTool<a class="td-heading-self-link" href="#greptool" aria-label="Heading self-link"></a></h2>
<p>Searches file contents using regular expressions.</p>
<h3 id="parameters-3">Parameters<a class="td-heading-self-link" href="#parameters-3" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>pattern</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Regular expression pattern to search for</td>
      </tr>
      <tr>
          <td><code>path</code></td>
          <td>string</td>
          <td>No</td>
          <td>Directory to search in (default: current directory)</td>
      </tr>
      <tr>
          <td><code>include</code></td>
          <td>string</td>
          <td>No</td>
          <td>File pattern to include in the search</td>
      </tr>
  </tbody>
</table>
<h3 id="response-3">Response<a class="td-heading-self-link" href="#response-3" aria-label="Heading self-link"></a></h3>
<p>A list of matches with file paths, line numbers, and matched content.</p>
<h2 id="ls">LS<a class="td-heading-self-link" href="#ls" aria-label="Heading self-link"></a></h2>
<p>Lists files and directories in a given path.</p>
<h3 id="parameters-4">Parameters<a class="td-heading-self-link" href="#parameters-4" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>path</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Absolute path to the directory to list</td>
      </tr>
      <tr>
          <td><code>ignore</code></td>
          <td>array</td>
          <td>No</td>
          <td>List of glob patterns to ignore</td>
      </tr>
  </tbody>
</table>
<h3 id="response-4">Response<a class="td-heading-self-link" href="#response-4" aria-label="Heading self-link"></a></h3>
<p>A list of files and directories with metadata.</p>
<h2 id="replace">Replace<a class="td-heading-self-link" href="#replace" aria-label="Heading self-link"></a></h2>
<p>Completely replaces a file&rsquo;s contents.</p>
<h3 id="parameters-5">Parameters<a class="td-heading-self-link" href="#parameters-5" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>file_path</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Absolute path to the file to write</td>
      </tr>
      <tr>
          <td><code>content</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Content to write to the file</td>
      </tr>
  </tbody>
</table>
<h3 id="response-5">Response<a class="td-heading-self-link" href="#response-5" aria-label="Heading self-link"></a></h3>
<p>Confirmation message with the content written.</p>
<h2 id="view">View<a class="td-heading-self-link" href="#view" aria-label="Heading self-link"></a></h2>
<p>Reads file contents with optional line range.</p>
<h3 id="parameters-6">Parameters<a class="td-heading-self-link" href="#parameters-6" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>file_path</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Absolute path to the file to read</td>
      </tr>
      <tr>
          <td><code>offset</code></td>
          <td>number</td>
          <td>No</td>
          <td>Line number to start reading from</td>
      </tr>
      <tr>
          <td><code>limit</code></td>
          <td>number</td>
          <td>No</td>
          <td>Number of lines to read</td>
      </tr>
  </tbody>
</table>
<h3 id="response-6">Response<a class="td-heading-self-link" href="#response-6" aria-label="Heading self-link"></a></h3>
<p>The file content with line numbers in cat -n format.</p>
<h2 id="dispatch_agent">dispatch_agent<a class="td-heading-self-link" href="#dispatch_agent" aria-label="Heading self-link"></a></h2>
<p>Launches a new agent with access to specific tools.</p>
<h3 id="parameters-7">Parameters<a class="td-heading-self-link" href="#parameters-7" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>prompt</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>The task for the agent to perform</td>
      </tr>
  </tbody>
</table>
<h3 id="response-7">Response<a class="td-heading-self-link" href="#response-7" aria-label="Heading self-link"></a></h3>
<p>The result of the agent&rsquo;s task execution.</p>
<h2 id="imagen">imagen<a class="td-heading-self-link" href="#imagen" aria-label="Heading self-link"></a></h2>
<p>Generates and manipulates images using Google&rsquo;s Imagen API.</p>
<h3 id="parameters-8">Parameters<a class="td-heading-self-link" href="#parameters-8" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>prompt</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Description of the image to generate</td>
      </tr>
      <tr>
          <td><code>aspectRatio</code></td>
          <td>string</td>
          <td>No</td>
          <td>Aspect ratio for the image (default: &ldquo;1:1&rdquo;)</td>
      </tr>
      <tr>
          <td><code>safetyFilterLevel</code></td>
          <td>string</td>
          <td>No</td>
          <td>Safety filter level (default: &ldquo;block_some&rdquo;)</td>
      </tr>
      <tr>
          <td><code>personGeneration</code></td>
          <td>string</td>
          <td>No</td>
          <td>Person generation policy (default: &ldquo;dont_allow&rdquo;)</td>
      </tr>
  </tbody>
</table>
<h3 id="response-8">Response<a class="td-heading-self-link" href="#response-8" aria-label="Heading self-link"></a></h3>
<p>Returns a JSON object with the generated image path and metadata.</p>
<h2 id="duckdbserver">duckdbserver<a class="td-heading-self-link" href="#duckdbserver" aria-label="Heading self-link"></a></h2>
<p>Provides data processing capabilities using DuckDB.</p>
<h3 id="parameters-9">Parameters<a class="td-heading-self-link" href="#parameters-9" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>query</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>SQL query to execute</td>
      </tr>
      <tr>
          <td><code>database</code></td>
          <td>string</td>
          <td>No</td>
          <td>Database file path (default: in-memory)</td>
      </tr>
  </tbody>
</table>
<h3 id="response-9">Response<a class="td-heading-self-link" href="#response-9" aria-label="Heading self-link"></a></h3>
<p>Query results in JSON format.</p>
<h2 id="imagen_edit">imagen_edit<a class="td-heading-self-link" href="#imagen_edit" aria-label="Heading self-link"></a></h2>
<p>Edits images using Google&rsquo;s Gemini 2.0 Flash model with natural language instructions.</p>
<h3 id="parameters-10">Parameters<a class="td-heading-self-link" href="#parameters-10" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>base64_image</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Base64 encoded image data (without data:image/&hellip; prefix)</td>
      </tr>
      <tr>
          <td><code>mime_type</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>MIME type of the image (e.g., &ldquo;image/jpeg&rdquo;, &ldquo;image/png&rdquo;)</td>
      </tr>
      <tr>
          <td><code>edit_instruction</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Text describing the edit to perform</td>
      </tr>
      <tr>
          <td><code>temperature</code></td>
          <td>number</td>
          <td>No</td>
          <td>Randomness in generation (0.0-2.0, default: 1.0)</td>
      </tr>
      <tr>
          <td><code>top_p</code></td>
          <td>number</td>
          <td>No</td>
          <td>Nucleus sampling parameter (0.0-1.0, default: 0.95)</td>
      </tr>
  </tbody>
</table>
<h3 id="response-10">Response<a class="td-heading-self-link" href="#response-10" aria-label="Heading self-link"></a></h3>
<p>Returns edited image information including file path and HTTP URL.</p>
<h2 id="plantuml">plantuml<a class="td-heading-self-link" href="#plantuml" aria-label="Heading self-link"></a></h2>
<p>Generates PlantUML diagram URLs from plain text diagrams with syntax validation and error correction.</p>
<h3 id="parameters-11">Parameters<a class="td-heading-self-link" href="#parameters-11" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>plantuml_code</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>PlantUML diagram code in plain text format</td>
      </tr>
      <tr>
          <td><code>output_format</code></td>
          <td>string</td>
          <td>No</td>
          <td>Output format: &ldquo;svg&rdquo; (default) or &ldquo;png&rdquo;</td>
      </tr>
  </tbody>
</table>
<h3 id="response-11">Response<a class="td-heading-self-link" href="#response-11" aria-label="Heading self-link"></a></h3>
<p>Returns URL pointing to PlantUML server for SVG/PNG rendering.</p>
<h2 id="plantuml_check">plantuml_check<a class="td-heading-self-link" href="#plantuml_check" aria-label="Heading self-link"></a></h2>
<p>Validates PlantUML file syntax using the official PlantUML processor.</p>
<h3 id="parameters-12">Parameters<a class="td-heading-self-link" href="#parameters-12" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>file_path</code></td>
          <td>string</td>
          <td>Yes</td>
          <td>Path to PlantUML file (.puml, .plantuml, .pu)</td>
      </tr>
  </tbody>
</table>
<h3 id="response-12">Response<a class="td-heading-self-link" href="#response-12" aria-label="Heading self-link"></a></h3>
<p>Returns validation result with detailed error messages if syntax issues are found.</p>
<h2 id="sleep">sleep<a class="td-heading-self-link" href="#sleep" aria-label="Heading self-link"></a></h2>
<p>Pauses execution for a specified number of seconds (useful for testing and demonstrations).</p>
<h3 id="parameters-13">Parameters<a class="td-heading-self-link" href="#parameters-13" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Required</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>seconds</code></td>
          <td>number</td>
          <td>Yes</td>
          <td>Number of seconds to sleep</td>
      </tr>
  </tbody>
</table>
<h3 id="response-13">Response<a class="td-heading-self-link" href="#response-13" aria-label="Heading self-link"></a></h3>
<p>Confirmation message after sleep completion.</p>
<h2 id="tool-response-format">Tool Response Format<a class="td-heading-self-link" href="#tool-response-format" aria-label="Heading self-link"></a></h2>
<p>Most tools return JSON responses with the following structure:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;result&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;...&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#8f5902;font-style:italic">// String result or
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">&#34;results&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#a40000">...</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#8f5902;font-style:italic">// Array of results
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>  <span style="color:#204a87;font-weight:bold">&#34;error&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;...&#34;</span> <span style="color:#8f5902;font-style:italic">// Error message if applicable
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="error-handling">Error Handling<a class="td-heading-self-link" href="#error-handling" aria-label="Heading self-link"></a></h2>
<p>All tools follow a consistent error reporting format:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;error&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Error message&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;code&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ERROR_CODE&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Common error codes include:</p>
<ul>
<li><code>INVALID_PARAMS</code>: Parameters are missing or invalid</li>
<li><code>EXECUTION_ERROR</code>: Error executing the requested operation</li>
<li><code>PERMISSION_DENIED</code>: Permission issues</li>
<li><code>TIMEOUT</code>: Operation timed out</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-61ac8e48954ec034d3d42bf3a56d2966">3.2 - OpenAI-Compatible Server Reference</h1>
    <div class="lead">Technical documentation of the server&rsquo;s architecture, API endpoints, and configuration</div>
	

<div class="pageinfo pageinfo-primary">
<p>This reference guide provides detailed technical documentation on the OpenAI-compatible server&rsquo;s architecture, API endpoints, configuration options, and integration details with Vertex AI.</p>

</div>

<h2 id="overview">Overview<a class="td-heading-self-link" href="#overview" aria-label="Heading self-link"></a></h2>
<p>The OpenAI-compatible server is a core component of the gomcptest system. It implements an API surface compatible with the OpenAI Chat Completions API while connecting to Google&rsquo;s Vertex AI for model inference. The server acts as a bridge between clients (like the modern AgentFlow web UI) and the underlying LLM models, handling session management, function calling, and tool execution.</p>
<h2 id="agentflow-web-ui">AgentFlow Web UI<a class="td-heading-self-link" href="#agentflow-web-ui" aria-label="Heading self-link"></a></h2>
<p>The server includes <strong>AgentFlow</strong>, a modern web-based interface that is <strong>embedded directly in the openaiserver binary</strong>. It provides:</p>
<ul>
<li><strong>Mobile-First Design</strong>: Optimized for iPhone and mobile devices</li>
<li><strong>Real-time Streaming</strong>: Server-sent events for immediate response display</li>
<li><strong>Professional Styling</strong>: Clean, modern interface with accessibility features</li>
<li><strong>Conversation Management</strong>: Persistent conversation history</li>
<li><strong>Attachment Support</strong>: File uploads including PDF support</li>
<li><strong>Embedded Architecture</strong>: Built into the main server binary for easy deployment</li>
</ul>
<h3 id="ui-access">UI Access<a class="td-heading-self-link" href="#ui-access" aria-label="Heading self-link"></a></h3>
<p>Access AgentFlow by starting the openaiserver and navigating to the <code>/ui</code> endpoint:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./bin/openaiserver
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># AgentFlow available at: http://localhost:8080/ui</span>
</span></span></code></pre></div><h3 id="development-note">Development Note<a class="td-heading-self-link" href="#development-note" aria-label="Heading self-link"></a></h3>
<p>The <code>host/openaiserver/simpleui</code> directory contains a standalone UI server used exclusively for development and testing. Production users should use the embedded UI via the <code>/ui</code> endpoint.</p>
<h2 id="api-endpoints">API Endpoints<a class="td-heading-self-link" href="#api-endpoints" aria-label="Heading self-link"></a></h2>
<h3 id="post-v1chatcompletions">POST /v1/chat/completions<a class="td-heading-self-link" href="#post-v1chatcompletions" aria-label="Heading self-link"></a></h3>
<p>The primary endpoint that mimics the OpenAI Chat Completions API.</p>
<h4 id="request">Request<a class="td-heading-self-link" href="#request" aria-label="Heading self-link"></a></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;model&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;gemini-pro&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;messages&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;role&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;system&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;content&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;You are a helpful assistant.&#34;</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;role&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;content&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Hello, world!&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;stream&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;max_tokens&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;temperature&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.7</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;functions&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;get_weather&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Get the current weather in a given location&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;object&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;properties&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;location&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;The city and state, e.g. San Francisco, CA&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;required&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;location&#34;</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="response-non-streamed">Response (non-streamed)<a class="td-heading-self-link" href="#response-non-streamed" aria-label="Heading self-link"></a></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;chatcmpl-123456789&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;object&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;chat.completion&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;created&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1677858242</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;model&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;gemini-pro&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;choices&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;role&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;assistant&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;content&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Hello! How can I help you today?&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;finish_reason&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;stop&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;index&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;usage&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;prompt_tokens&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">13</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;completion_tokens&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">7</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;total_tokens&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">20</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="response-streamed">Response (streamed)<a class="td-heading-self-link" href="#response-streamed" aria-label="Heading self-link"></a></h4>
<p>When <code>stream</code> is set to <code>true</code>, the server returns a stream of SSE (Server-Sent Events) with partial responses:</p>
<pre tabindex="0"><code>data: {&#34;id&#34;:&#34;chatcmpl-123456789&#34;,&#34;object&#34;:&#34;chat.completion.chunk&#34;,&#34;created&#34;:1677858242,&#34;model&#34;:&#34;gemini-pro&#34;,&#34;choices&#34;:[{&#34;delta&#34;:{&#34;role&#34;:&#34;assistant&#34;},&#34;index&#34;:0,&#34;finish_reason&#34;:null}]}

data: {&#34;id&#34;:&#34;chatcmpl-123456789&#34;,&#34;object&#34;:&#34;chat.completion.chunk&#34;,&#34;created&#34;:1677858242,&#34;model&#34;:&#34;gemini-pro&#34;,&#34;choices&#34;:[{&#34;delta&#34;:{&#34;content&#34;:&#34;Hello&#34;},&#34;index&#34;:0,&#34;finish_reason&#34;:null}]}

data: {&#34;id&#34;:&#34;chatcmpl-123456789&#34;,&#34;object&#34;:&#34;chat.completion.chunk&#34;,&#34;created&#34;:1677858242,&#34;model&#34;:&#34;gemini-pro&#34;,&#34;choices&#34;:[{&#34;delta&#34;:{&#34;content&#34;:&#34;!&#34;},&#34;index&#34;:0,&#34;finish_reason&#34;:null}]}

data: {&#34;id&#34;:&#34;chatcmpl-123456789&#34;,&#34;object&#34;:&#34;chat.completion.chunk&#34;,&#34;created&#34;:1677858242,&#34;model&#34;:&#34;gemini-pro&#34;,&#34;choices&#34;:[{&#34;delta&#34;:{&#34;content&#34;:&#34; How&#34;},&#34;index&#34;:0,&#34;finish_reason&#34;:null}]}

data: {&#34;id&#34;:&#34;chatcmpl-123456789&#34;,&#34;object&#34;:&#34;chat.completion.chunk&#34;,&#34;created&#34;:1677858242,&#34;model&#34;:&#34;gemini-pro&#34;,&#34;choices&#34;:[{&#34;delta&#34;:{},&#34;index&#34;:0,&#34;finish_reason&#34;:&#34;stop&#34;}]}

data: [DONE]
</code></pre><h2 id="supported-features">Supported Features<a class="td-heading-self-link" href="#supported-features" aria-label="Heading self-link"></a></h2>
<h3 id="models">Models<a class="td-heading-self-link" href="#models" aria-label="Heading self-link"></a></h3>
<p>The server supports the following Vertex AI models:</p>
<ul>
<li><code>gemini-1.5-pro</code></li>
<li><code>gemini-2.0-flash</code></li>
<li><code>gemini-pro-vision</code> (legacy)</li>
</ul>
<h3 id="vertex-ai-built-in-tools">Vertex AI Built-in Tools<a class="td-heading-self-link" href="#vertex-ai-built-in-tools" aria-label="Heading self-link"></a></h3>
<p>The server supports Google&rsquo;s native Vertex AI tools:</p>
<ul>
<li><strong>Code Execution</strong>: Enables the model to execute code as part of generation</li>
<li><strong>Google Search</strong>: Specialized search tool powered by Google</li>
<li><strong>Google Search Retrieval</strong>: Advanced retrieval tool with Google search backend</li>
</ul>
<h3 id="parameters">Parameters<a class="td-heading-self-link" href="#parameters" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Parameter</th>
          <th>Type</th>
          <th>Default</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>model</code></td>
          <td>string</td>
          <td><code>gemini-pro</code></td>
          <td>The model to use for generating completions</td>
      </tr>
      <tr>
          <td><code>messages</code></td>
          <td>array</td>
          <td>Required</td>
          <td>An array of messages in the conversation</td>
      </tr>
      <tr>
          <td><code>stream</code></td>
          <td>boolean</td>
          <td><code>false</code></td>
          <td>Whether to stream the response or not</td>
      </tr>
      <tr>
          <td><code>max_tokens</code></td>
          <td>integer</td>
          <td>1024</td>
          <td>Maximum number of tokens to generate</td>
      </tr>
      <tr>
          <td><code>temperature</code></td>
          <td>number</td>
          <td>0.7</td>
          <td>Sampling temperature (0-1)</td>
      </tr>
      <tr>
          <td><code>functions</code></td>
          <td>array</td>
          <td><code>[]</code></td>
          <td>Function definitions the model can call</td>
      </tr>
      <tr>
          <td><code>function_call</code></td>
          <td>string or object</td>
          <td><code>auto</code></td>
          <td>Controls function calling behavior</td>
      </tr>
  </tbody>
</table>
<h3 id="function-calling">Function Calling<a class="td-heading-self-link" href="#function-calling" aria-label="Heading self-link"></a></h3>
<p>The server supports function calling similar to the OpenAI API. When the model identifies that a function should be called, the server:</p>
<ol>
<li>Parses the function call parameters</li>
<li>Locates the appropriate MCP tool</li>
<li>Executes the tool with the provided parameters</li>
<li>Returns the result to the model for further processing</li>
</ol>
<h2 id="architecture">Architecture<a class="td-heading-self-link" href="#architecture" aria-label="Heading self-link"></a></h2>
<p>The server consists of these key components:</p>
<h3 id="http-server">HTTP Server<a class="td-heading-self-link" href="#http-server" aria-label="Heading self-link"></a></h3>
<p>A standard Go HTTP server that handles incoming requests and routes them to the appropriate handlers.</p>
<h3 id="session-manager">Session Manager<a class="td-heading-self-link" href="#session-manager" aria-label="Heading self-link"></a></h3>
<p>Maintains chat history and context for ongoing conversations. Ensures that the model has necessary context when generating responses.</p>
<h3 id="vertex-ai-client">Vertex AI Client<a class="td-heading-self-link" href="#vertex-ai-client" aria-label="Heading self-link"></a></h3>
<p>Communicates with Google&rsquo;s Vertex AI API to:</p>
<ul>
<li>Send prompt templates to the model</li>
<li>Receive completions from the model</li>
<li>Stream partial responses back to the client</li>
</ul>
<h3 id="mcp-tool-manager">MCP Tool Manager<a class="td-heading-self-link" href="#mcp-tool-manager" aria-label="Heading self-link"></a></h3>
<p>Manages the available MCP tools and handles:</p>
<ul>
<li>Tool registration and discovery</li>
<li>Parameter validation</li>
<li>Tool execution</li>
<li>Response processing</li>
</ul>
<h3 id="response-streamer">Response Streamer<a class="td-heading-self-link" href="#response-streamer" aria-label="Heading self-link"></a></h3>
<p>Handles streaming responses to clients in SSE format, ensuring low latency and progressive rendering.</p>
<h2 id="configuration">Configuration<a class="td-heading-self-link" href="#configuration" aria-label="Heading self-link"></a></h2>
<p>The server can be configured using environment variables:</p>
<h3 id="core-configuration">Core Configuration<a class="td-heading-self-link" href="#core-configuration" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Variable</th>
          <th>Description</th>
          <th>Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>GCP_PROJECT</code></td>
          <td>Google Cloud project ID</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>GCP_REGION</code></td>
          <td>Google Cloud region</td>
          <td><code>us-central1</code></td>
      </tr>
      <tr>
          <td><code>GEMINI_MODELS</code></td>
          <td>Comma-separated list of available models</td>
          <td><code>gemini-1.5-pro,gemini-2.0-flash</code></td>
      </tr>
      <tr>
          <td><code>PORT</code></td>
          <td>HTTP server port</td>
          <td><code>8080</code></td>
      </tr>
      <tr>
          <td><code>LOG_LEVEL</code></td>
          <td>Logging level (DEBUG, INFO, WARN, ERROR)</td>
          <td><code>INFO</code></td>
      </tr>
  </tbody>
</table>
<h3 id="vertex-ai-tools-configuration">Vertex AI Tools Configuration<a class="td-heading-self-link" href="#vertex-ai-tools-configuration" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Variable</th>
          <th>Description</th>
          <th>Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>VERTEX_AI_CODE_EXECUTION</code></td>
          <td>Enable Code Execution tool</td>
          <td><code>false</code></td>
      </tr>
      <tr>
          <td><code>VERTEX_AI_GOOGLE_SEARCH</code></td>
          <td>Enable Google Search tool</td>
          <td><code>false</code></td>
      </tr>
      <tr>
          <td><code>VERTEX_AI_GOOGLE_SEARCH_RETRIEVAL</code></td>
          <td>Enable Google Search Retrieval tool</td>
          <td><code>false</code></td>
      </tr>
  </tbody>
</table>
<h3 id="legacy-configuration">Legacy Configuration<a class="td-heading-self-link" href="#legacy-configuration" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Variable</th>
          <th>Description</th>
          <th>Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>GOOGLE_APPLICATION_CREDENTIALS</code></td>
          <td>Path to Google Cloud credentials file</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>GOOGLE_CLOUD_PROJECT</code></td>
          <td>Legacy alias for GCP_PROJECT</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>GOOGLE_CLOUD_LOCATION</code></td>
          <td>Legacy alias for GCP_REGION</td>
          <td><code>us-central1</code></td>
      </tr>
  </tbody>
</table>
<h2 id="error-handling">Error Handling<a class="td-heading-self-link" href="#error-handling" aria-label="Heading self-link"></a></h2>
<p>The server implements consistent error handling with HTTP status codes:</p>
<table>
  <thead>
      <tr>
          <th>Status Code</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>400</td>
          <td>Bad Request - Invalid parameters or request format</td>
      </tr>
      <tr>
          <td>401</td>
          <td>Unauthorized - Missing or invalid authentication</td>
      </tr>
      <tr>
          <td>404</td>
          <td>Not Found - Model or endpoint not found</td>
      </tr>
      <tr>
          <td>429</td>
          <td>Too Many Requests - Rate limit exceeded</td>
      </tr>
      <tr>
          <td>500</td>
          <td>Internal Server Error - Server-side error</td>
      </tr>
      <tr>
          <td>503</td>
          <td>Service Unavailable - Vertex AI service unavailable</td>
      </tr>
  </tbody>
</table>
<p>Error responses follow this format:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;error&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Detailed error message&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;error_type&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;param&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;parameter_name&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;code&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;error_code&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="security-considerations">Security Considerations<a class="td-heading-self-link" href="#security-considerations" aria-label="Heading self-link"></a></h2>
<p>The server does not implement authentication or authorization by default. In production deployments, consider:</p>
<ul>
<li>Running behind a reverse proxy with authentication</li>
<li>Using API keys or OAuth2</li>
<li>Implementing rate limiting</li>
<li>Setting up proper firewall rules</li>
</ul>
<h2 id="examples">Examples<a class="td-heading-self-link" href="#examples" aria-label="Heading self-link"></a></h2>
<h3 id="basic-usage">Basic Usage<a class="td-heading-self-link" href="#basic-usage" aria-label="Heading self-link"></a></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;your-project-id&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_REGION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;us-central1&#34;</span>
</span></span><span style="display:flex;"><span>./bin/openaiserver
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Access AgentFlow UI at: http://localhost:8080/ui</span>
</span></span></code></pre></div><h3 id="with-vertex-ai-tools">With Vertex AI Tools<a class="td-heading-self-link" href="#with-vertex-ai-tools" aria-label="Heading self-link"></a></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;your-project-id&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">VERTEX_AI_CODE_EXECUTION</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87">true</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">VERTEX_AI_GOOGLE_SEARCH</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87">true</span>
</span></span><span style="display:flex;"><span>./bin/openaiserver
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># AgentFlow UI with Vertex AI tools at: http://localhost:8080/ui</span>
</span></span></code></pre></div><h3 id="development-ui-server-for-developers-only">Development UI Server (For Developers Only)<a class="td-heading-self-link" href="#development-ui-server-for-developers-only" aria-label="Heading self-link"></a></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Terminal 1: Start API server</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">export</span> <span style="color:#000">GCP_PROJECT</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#34;your-project-id&#34;</span>
</span></span><span style="display:flex;"><span>./bin/openaiserver -port<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">4000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Terminal 2: Start development UI server</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">cd</span> host/openaiserver/simpleui
</span></span><span style="display:flex;"><span>go run . -ui-port<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">8081</span> -api-url<span style="color:#ce5c00;font-weight:bold">=</span>http://localhost:4000
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Development UI at: http://localhost:8081</span>
</span></span></code></pre></div><p><strong>Note</strong>: The standalone UI server is for development purposes only. Production users should use the embedded UI via <code>/ui</code>.</p>
<h3 id="client-connection">Client Connection<a class="td-heading-self-link" href="#client-connection" aria-label="Heading self-link"></a></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl -X POST http://localhost:8080/v1/chat/completions <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>  -H <span style="color:#4e9a06">&#34;Content-Type: application/json&#34;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>  -d <span style="color:#4e9a06">&#39;{
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">    &#34;model&#34;: &#34;gemini-2.0-flash&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">    &#34;messages&#34;: [{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;Hello, world!&#34;}]
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">  }&#39;</span>
</span></span></code></pre></div><h2 id="limitations">Limitations<a class="td-heading-self-link" href="#limitations" aria-label="Heading self-link"></a></h2>
<ul>
<li>Single chat session support only</li>
<li>No persistent storage of conversations</li>
<li>Limited authentication options</li>
<li>Basic rate limiting</li>
<li>Limited model parameter controls</li>
</ul>
<h2 id="advanced-usage">Advanced Usage<a class="td-heading-self-link" href="#advanced-usage" aria-label="Heading self-link"></a></h2>
<h3 id="tool-registration">Tool Registration<a class="td-heading-self-link" href="#tool-registration" aria-label="Heading self-link"></a></h3>
<p>Tools are automatically registered when the server starts. To register custom tools:</p>
<ol>
<li>Place executable files in the <code>MCP_TOOLS_PATH</code> directory</li>
<li>Ensure they follow the MCP protocol</li>
<li>Restart the server</li>
</ol>
<h3 id="streaming-with-function-calls">Streaming with Function Calls<a class="td-heading-self-link" href="#streaming-with-function-calls" aria-label="Heading self-link"></a></h3>
<p>When using function calling with streaming, the stream will pause during tool execution and resume with the tool results included in the context.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-2d55ee040b4d2da5feeb8c0dc85e1391">3.3 - cliGCP Reference (Deprecated)</h1>
    <div class="lead">Detailed reference of the cliGCP command-line interface (deprecated in favor of AgentFlow UI)</div>
	

<div class="pageinfo pageinfo-warning">
<p><strong>‚ö†Ô∏è DEPRECATED</strong>: The cliGCP command-line interface is deprecated in favor of the modern <strong>AgentFlow web UI</strong>. New users should use the <a href="/gomcptest/docs/reference/openaiserver/#agentflow-web-ui">AgentFlow UI</a> instead. This documentation is maintained for legacy users.</p>

</div>

<h2 id="overview">Overview<a class="td-heading-self-link" href="#overview" aria-label="Heading self-link"></a></h2>
<p>The cliGCP (Command Line Interface for Google Cloud Platform) is a legacy command-line tool that provides a chat interface similar to tools like &ldquo;Claude Code&rdquo; or &ldquo;ChatGPT&rdquo;. It connects to an OpenAI-compatible server and allows users to interact with LLMs and MCP tools through a conversational interface.</p>
<p><strong>For new projects, we recommend using the <a href="/gomcptest/docs/reference/openaiserver/#agentflow-web-ui">AgentFlow web UI</a> which provides a modern, mobile-optimized interface with better features and user experience.</strong></p>
<h2 id="command-structure">Command Structure<a class="td-heading-self-link" href="#command-structure" aria-label="Heading self-link"></a></h2>
<h3 id="basic-usage">Basic Usage<a class="td-heading-self-link" href="#basic-usage" aria-label="Heading self-link"></a></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./bin/cliGCP <span style="color:#ce5c00;font-weight:bold">[</span>flags<span style="color:#ce5c00;font-weight:bold">]</span>
</span></span></code></pre></div><h3 id="flags">Flags<a class="td-heading-self-link" href="#flags" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Flag</th>
          <th>Description</th>
          <th>Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>-mcpservers</code></td>
          <td>Comma-separated list of MCP tool paths</td>
          <td>&quot;&quot;</td>
      </tr>
      <tr>
          <td><code>-server</code></td>
          <td>URL of the OpenAI-compatible server</td>
          <td>&ldquo;http://localhost:8080&rdquo;</td>
      </tr>
      <tr>
          <td><code>-model</code></td>
          <td>LLM model to use</td>
          <td>&ldquo;gemini-pro&rdquo;</td>
      </tr>
      <tr>
          <td><code>-prompt</code></td>
          <td>Initial system prompt</td>
          <td>&ldquo;You are a helpful assistant.&rdquo;</td>
      </tr>
      <tr>
          <td><code>-temp</code></td>
          <td>Temperature setting for model responses</td>
          <td>0.7</td>
      </tr>
      <tr>
          <td><code>-maxtokens</code></td>
          <td>Maximum number of tokens in responses</td>
          <td>1024</td>
      </tr>
      <tr>
          <td><code>-history</code></td>
          <td>File path to store/load chat history</td>
          <td>&quot;&quot;</td>
      </tr>
      <tr>
          <td><code>-verbose</code></td>
          <td>Enable verbose logging</td>
          <td>false</td>
      </tr>
  </tbody>
</table>
<h3 id="example">Example<a class="td-heading-self-link" href="#example" aria-label="Heading self-link"></a></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./bin/cliGCP -mcpservers <span style="color:#4e9a06">&#34;./bin/Bash;./bin/View;./bin/GlobTool;./bin/GrepTool;./bin/LS;./bin/Edit;./bin/Replace;./bin/dispatch_agent&#34;</span> -server <span style="color:#4e9a06">&#34;http://localhost:8080&#34;</span> -model <span style="color:#4e9a06">&#34;gemini-pro&#34;</span> -prompt <span style="color:#4e9a06">&#34;You are a helpful command-line assistant.&#34;</span>
</span></span></code></pre></div><h2 id="components">Components<a class="td-heading-self-link" href="#components" aria-label="Heading self-link"></a></h2>
<h3 id="chat-interface">Chat Interface<a class="td-heading-self-link" href="#chat-interface" aria-label="Heading self-link"></a></h3>
<p>The chat interface provides:</p>
<ul>
<li>Text-based input for user messages</li>
<li>Markdown rendering of AI responses</li>
<li>Real-time streaming of responses</li>
<li>Input history and navigation</li>
<li>Multi-line input support</li>
</ul>
<h3 id="mcp-tool-manager">MCP Tool Manager<a class="td-heading-self-link" href="#mcp-tool-manager" aria-label="Heading self-link"></a></h3>
<p>The tool manager:</p>
<ul>
<li>Loads and initializes MCP tools</li>
<li>Registers tools with the OpenAI-compatible server</li>
<li>Routes function calls to appropriate tools</li>
<li>Processes tool results</li>
</ul>
<h3 id="session-manager">Session Manager<a class="td-heading-self-link" href="#session-manager" aria-label="Heading self-link"></a></h3>
<p>The session manager:</p>
<ul>
<li>Maintains chat history within the session</li>
<li>Handles context windowing for long conversations</li>
<li>Optionally persists conversations to disk</li>
<li>Provides conversation resume functionality</li>
</ul>
<h2 id="interaction-patterns">Interaction Patterns<a class="td-heading-self-link" href="#interaction-patterns" aria-label="Heading self-link"></a></h2>
<h3 id="basic-chat">Basic Chat<a class="td-heading-self-link" href="#basic-chat" aria-label="Heading self-link"></a></h3>
<p>The most common interaction pattern is a simple turn-based chat:</p>
<ol>
<li>User enters a message</li>
<li>Model generates and streams a response</li>
<li>Chat history is updated</li>
<li>User enters the next message</li>
</ol>
<h3 id="function-calling">Function Calling<a class="td-heading-self-link" href="#function-calling" aria-label="Heading self-link"></a></h3>
<p>When the model determines a function should be called:</p>
<ol>
<li>User enters a message requesting an action (e.g., &ldquo;List files in /tmp&rdquo;)</li>
<li>Model analyzes the request and generates a function call</li>
<li>cliGCP intercepts the function call and routes it to the appropriate tool</li>
<li>Tool executes and returns results</li>
<li>Results are injected back into the model&rsquo;s context</li>
<li>Model continues generating a response that incorporates the tool results</li>
<li>The complete response is shown to the user</li>
</ol>
<h3 id="multi-turn-function-calling">Multi-turn Function Calling<a class="td-heading-self-link" href="#multi-turn-function-calling" aria-label="Heading self-link"></a></h3>
<p>For complex tasks, the model may make multiple function calls:</p>
<ol>
<li>User requests a complex task (e.g., &ldquo;Find all Python files containing &rsquo;error&rsquo;&rdquo;)</li>
<li>Model makes a function call to list directories</li>
<li>Tool returns directory listing</li>
<li>Model makes additional function calls to search file contents</li>
<li>Each tool result is returned to the model</li>
<li>Model synthesizes the information and responds to the user</li>
</ol>
<h2 id="technical-details">Technical Details<a class="td-heading-self-link" href="#technical-details" aria-label="Heading self-link"></a></h2>
<h3 id="message-format">Message Format<a class="td-heading-self-link" href="#message-format" aria-label="Heading self-link"></a></h3>
<p>Messages between cliGCP and the server follow the OpenAI Chat API format:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;role&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;user&#34;</span><span style="color:#a40000">|</span><span style="color:#4e9a06">&#34;assistant&#34;</span><span style="color:#a40000">|</span><span style="color:#4e9a06">&#34;system&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;content&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Message text&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Function calls use this format:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;role&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;assistant&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;content&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;function_call&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;function_name&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;arguments&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;{\&#34;arg1\&#34;:\&#34;value1\&#34;,\&#34;arg2\&#34;:\&#34;value2\&#34;}&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="tool-registration">Tool Registration<a class="td-heading-self-link" href="#tool-registration" aria-label="Heading self-link"></a></h3>
<p>Tools are registered with the server using JSONSchema:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;tool_name&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Tool description&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;object&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;properties&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;param1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Parameter description&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;required&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;param1&#34;</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="error-handling">Error Handling<a class="td-heading-self-link" href="#error-handling" aria-label="Heading self-link"></a></h3>
<p>The CLI implements robust error handling for:</p>
<ul>
<li>Connection issues with the server</li>
<li>Tool execution failures</li>
<li>Model errors</li>
<li>Input validation</li>
</ul>
<p>Error messages are displayed to the user with context and possible solutions.</p>
<h2 id="configuration">Configuration<a class="td-heading-self-link" href="#configuration" aria-label="Heading self-link"></a></h2>
<h3 id="environment-variables">Environment Variables<a class="td-heading-self-link" href="#environment-variables" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Variable</th>
          <th>Description</th>
          <th>Default</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>OPENAI_API_URL</code></td>
          <td>URL of the OpenAI-compatible server</td>
          <td>http://localhost:8080</td>
      </tr>
      <tr>
          <td><code>OPENAI_API_KEY</code></td>
          <td>API key for authentication (if required)</td>
          <td>&quot;&quot;</td>
      </tr>
      <tr>
          <td><code>MCP_TOOLS_PATH</code></td>
          <td>Path to MCP tools (overridden by -mcpservers)</td>
          <td>&ldquo;./tools&rdquo;</td>
      </tr>
      <tr>
          <td><code>DEFAULT_MODEL</code></td>
          <td>Default model to use</td>
          <td>&ldquo;gemini-pro&rdquo;</td>
      </tr>
      <tr>
          <td><code>SYSTEM_PROMPT</code></td>
          <td>Default system prompt</td>
          <td>&ldquo;You are a helpful assistant.&rdquo;</td>
      </tr>
  </tbody>
</table>
<h3 id="configuration-file">Configuration File<a class="td-heading-self-link" href="#configuration-file" aria-label="Heading self-link"></a></h3>
<p>You can create a <code>~/.cligcp.json</code> configuration file with these settings:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;server&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;http://localhost:8080&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;model&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;gemini-pro&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;prompt&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;You are a helpful assistant.&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;temperature&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0.7</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;max_tokens&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">1024</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;tools&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;./bin/Bash&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;./bin/View&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;./bin/GlobTool&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="advanced-usage">Advanced Usage<a class="td-heading-self-link" href="#advanced-usage" aria-label="Heading self-link"></a></h2>
<h3 id="persistent-history">Persistent History<a class="td-heading-self-link" href="#persistent-history" aria-label="Heading self-link"></a></h3>
<p>To save and load chat history:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./bin/cliGCP -history ./chat_history.json
</span></span></code></pre></div><h3 id="custom-system-prompt">Custom System Prompt<a class="td-heading-self-link" href="#custom-system-prompt" aria-label="Heading self-link"></a></h3>
<p>To set a specific system prompt:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./bin/cliGCP -prompt <span style="color:#4e9a06">&#34;You are a Linux command-line expert that helps users with shell commands and filesystem operations.&#34;</span>
</span></span></code></pre></div><h3 id="combining-with-shell-scripts">Combining with Shell Scripts<a class="td-heading-self-link" href="#combining-with-shell-scripts" aria-label="Heading self-link"></a></h3>
<p>You can use cliGCP in shell scripts by piping input and capturing output:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#204a87">echo</span> <span style="color:#4e9a06">&#34;Explain how to find large files in Linux&#34;</span> <span style="color:#000;font-weight:bold">|</span> ./bin/cliGCP -noninteractive
</span></span></code></pre></div><h2 id="limitations">Limitations<a class="td-heading-self-link" href="#limitations" aria-label="Heading self-link"></a></h2>
<ul>
<li>Single conversation per instance</li>
<li>Limited rendering capabilities for complex markdown</li>
<li>No built-in authentication management</li>
<li>Limited offline functionality</li>
<li>No multi-modal input support (e.g., images)</li>
</ul>
<h2 id="troubleshooting">Troubleshooting<a class="td-heading-self-link" href="#troubleshooting" aria-label="Heading self-link"></a></h2>
<h3 id="common-issues">Common Issues<a class="td-heading-self-link" href="#common-issues" aria-label="Heading self-link"></a></h3>
<table>
  <thead>
      <tr>
          <th>Issue</th>
          <th>Possible Solution</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Connection refused</td>
          <td>Ensure the OpenAI server is running</td>
      </tr>
      <tr>
          <td>Tool not found</td>
          <td>Check tool paths and permissions</td>
      </tr>
      <tr>
          <td>Out of memory</td>
          <td>Reduce history size or split conversation</td>
      </tr>
      <tr>
          <td>Slow responses</td>
          <td>Check network connection and server load</td>
      </tr>
  </tbody>
</table>
<h3 id="diagnostic-mode">Diagnostic Mode<a class="td-heading-self-link" href="#diagnostic-mode" aria-label="Heading self-link"></a></h3>
<p>Run with the <code>-verbose</code> flag to enable detailed logging:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./bin/cliGCP -verbose
</span></span></code></pre></div><p>This will show all API requests, responses, and tool interactions, which can be helpful for debugging.</p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-85582929df2cd71a593c6114cfeed168">4 - Explanation</h1>
    <div class="lead">Understanding-oriented content for gomcptest architecture and concepts</div>
	

<div class="pageinfo pageinfo-primary">
<p>Explanation documents discuss and clarify concepts to broaden the reader&rsquo;s understanding of topics. They provide context and illuminate ideas.</p>

</div>

<p>This section provides deeper background on how gomcptest works, its architecture, and the concepts behind it. The explanations are organized from foundational concepts to specific implementations:</p>
<ol>
<li><strong><a href="/gomcptest/docs/explanation/architecture/">Architecture</a></strong> - Overall system design and component relationships</li>
<li><strong><a href="/gomcptest/docs/explanation/mcp-protocol/">MCP Protocol</a></strong> - Core protocol concepts and communication patterns</li>
<li><strong><a href="/gomcptest/docs/explanation/event-system/">Event System</a></strong> - Real-time event architecture for transparency and monitoring</li>
<li><strong><a href="/gomcptest/docs/explanation/tools-details/">MCP Tools</a></strong> - Tool implementation details and design patterns</li>
<li><strong><a href="/gomcptest/docs/explanation/agentflow/">AgentFlow Implementation</a></strong> - Specific web interface implementation of the event system</li>
</ol>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b0b996368ba948f31e52a0671d2c62fe">4.1 - gomcptest Architecture</h1>
    <div class="lead">Deep dive into the system architecture and design decisions</div>
	

<div class="pageinfo pageinfo-primary">
<p>This document explains the architecture of gomcptest, the design decisions behind it, and how the various components interact to create a custom Model Context Protocol (MCP) host.</p>

</div>

<h2 id="the-big-picture">The Big Picture<a class="td-heading-self-link" href="#the-big-picture" aria-label="Heading self-link"></a></h2>
<p>The gomcptest project implements a custom host that provides a Model Context Protocol (MCP) implementation. It&rsquo;s designed to enable testing and experimentation with agentic systems without requiring direct integration with commercial LLM platforms.</p>
<p>The system is built with these key principles in mind:</p>
<ul>
<li>Modularity: Components are designed to be interchangeable</li>
<li>Compatibility: The API mimics the OpenAI API for easy integration</li>
<li>Extensibility: New tools can be easily added to the system</li>
<li>Testing: The architecture facilitates testing of agentic applications</li>
</ul>
<h2 id="core-components">Core Components<a class="td-heading-self-link" href="#core-components" aria-label="Heading self-link"></a></h2>
<h3 id="host-openai-server">Host (OpenAI Server)<a class="td-heading-self-link" href="#host-openai-server" aria-label="Heading self-link"></a></h3>
<p>The host is the central component, located in <code>/host/openaiserver</code>. It presents an OpenAI-compatible API interface and connects to Google&rsquo;s Vertex AI for model inference. This compatibility layer makes it easy to integrate with existing tools and libraries designed for OpenAI.</p>
<p>The host has several key responsibilities:</p>
<ol>
<li><strong>API Compatibility</strong>: Implementing the OpenAI chat completions API</li>
<li><strong>Session Management</strong>: Maintaining chat history and context</li>
<li><strong>Model Integration</strong>: Connecting to Vertex AI&rsquo;s Gemini models</li>
<li><strong>Function Calling</strong>: Orchestrating function/tool calls based on model outputs</li>
<li><strong>Response Streaming</strong>: Supporting streaming responses to the client</li>
</ol>
<p>Unlike commercial implementations, this host is designed for local development and testing, emphasizing flexibility and observability over production-ready features like authentication or rate limiting.</p>
<h3 id="mcp-tools">MCP Tools<a class="td-heading-self-link" href="#mcp-tools" aria-label="Heading self-link"></a></h3>
<p>The tools are standalone executables that implement the Model Context Protocol. Each tool is designed to perform a specific function, such as executing shell commands or manipulating files.</p>
<p>Tools follow a consistent pattern:</p>
<ul>
<li>They communicate via standard I/O using the MCP JSON-RPC protocol</li>
<li>They expose a specific set of parameters</li>
<li>They handle their own error conditions</li>
<li>They return results in a standardized format</li>
</ul>
<p>This approach allows tools to be:</p>
<ul>
<li>Developed independently</li>
<li>Tested in isolation</li>
<li>Used in different host environments</li>
<li>Chained together in complex workflows</li>
</ul>
<h3 id="cli">CLI<a class="td-heading-self-link" href="#cli" aria-label="Heading self-link"></a></h3>
<p>The CLI provides a user interface similar to tools like &ldquo;Claude Code&rdquo; or &ldquo;OpenAI ChatGPT&rdquo;. It connects to the OpenAI-compatible server and provides a way to interact with the LLM and tools through a conversational interface.</p>
<h2 id="data-flow">Data Flow<a class="td-heading-self-link" href="#data-flow" aria-label="Heading self-link"></a></h2>
<ol>
<li>The user sends a request to the CLI</li>
<li>The CLI forwards this request to the OpenAI-compatible server</li>
<li>The server sends the request to Vertex AI&rsquo;s Gemini model</li>
<li>The model may identify function calls in its response</li>
<li>The server executes these function calls by invoking the appropriate MCP tools</li>
<li>The results are provided back to the model to continue its response</li>
<li>The final response is streamed back to the CLI and presented to the user</li>
</ol>
<h2 id="design-decisions-explained">Design Decisions Explained<a class="td-heading-self-link" href="#design-decisions-explained" aria-label="Heading self-link"></a></h2>
<h3 id="why-openai-api-compatibility">Why OpenAI API Compatibility?<a class="td-heading-self-link" href="#why-openai-api-compatibility" aria-label="Heading self-link"></a></h3>
<p>The OpenAI API has become a de facto standard in the LLM space. By implementing this interface, gomcptest can work with a wide variety of existing tools, libraries, and frontends with minimal adaptation.</p>
<h3 id="why-google-vertex-ai">Why Google Vertex AI?<a class="td-heading-self-link" href="#why-google-vertex-ai" aria-label="Heading self-link"></a></h3>
<p>Vertex AI provides access to Google&rsquo;s Gemini models, which have strong function calling capabilities. The implementation could be extended to support other model providers as needed.</p>
<h3 id="why-standalone-tools">Why Standalone Tools?<a class="td-heading-self-link" href="#why-standalone-tools" aria-label="Heading self-link"></a></h3>
<p>By implementing tools as standalone executables rather than library functions, we gain several advantages:</p>
<ul>
<li>Security through isolation</li>
<li>Language agnosticism (tools can be written in any language)</li>
<li>Ability to distribute tools separately from the host</li>
<li>Easier testing and development</li>
</ul>
<h3 id="why-mcp">Why MCP?<a class="td-heading-self-link" href="#why-mcp" aria-label="Heading self-link"></a></h3>
<p>The Model Context Protocol provides a standardized way for LLMs to interact with external tools. By adopting this protocol, gomcptest ensures compatibility with tools developed for other MCP-compatible hosts.</p>
<h2 id="limitations-and-future-directions">Limitations and Future Directions<a class="td-heading-self-link" href="#limitations-and-future-directions" aria-label="Heading self-link"></a></h2>
<p>The current implementation has several limitations:</p>
<ul>
<li>Single chat session per instance</li>
<li>Limited support for authentication and authorization</li>
<li>No persistence of chat history between restarts</li>
<li>No built-in support for rate limiting or quotas</li>
</ul>
<p>Future enhancements could include:</p>
<ul>
<li>Support for multiple chat sessions</li>
<li>Integration with additional model providers</li>
<li>Enhanced security features</li>
<li>Improved error handling and logging</li>
<li>Performance optimizations for large-scale deployments</li>
</ul>
<h2 id="conclusion">Conclusion<a class="td-heading-self-link" href="#conclusion" aria-label="Heading self-link"></a></h2>
<p>The gomcptest architecture represents a flexible and extensible approach to building custom MCP hosts. It prioritizes simplicity, modularity, and developer experience, making it an excellent platform for experimentation with agentic systems.</p>
<p>By understanding this architecture, developers can effectively utilize the system, extend it with new tools, and potentially adapt it for their specific needs.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-090f1260bedc244a0c4b89f7e6660bd9">4.2 - Understanding the Model Context Protocol (MCP)</h1>
    <div class="lead">Exploration of what MCP is, how it works, and design decisions behind it</div>
	

<div class="pageinfo pageinfo-primary">
<p>This document explores the Model Context Protocol (MCP), how it works, the design decisions behind it, and how it compares to alternative approaches for LLM tool integration.</p>

</div>

<h2 id="what-is-the-model-context-protocol">What is the Model Context Protocol?<a class="td-heading-self-link" href="#what-is-the-model-context-protocol" aria-label="Heading self-link"></a></h2>
<p>The Model Context Protocol (MCP) is a standardized communication protocol that enables Large Language Models (LLMs) to interact with external tools and capabilities. It defines a structured way for models to request information or take actions in the real world, and for tools to provide responses back to the model.</p>
<p>MCP is designed to solve the problem of extending LLMs beyond their training data by giving them access to:</p>
<ul>
<li>Current information (e.g., via web search)</li>
<li>Computational capabilities (e.g., calculators, code execution)</li>
<li>External systems (e.g., databases, APIs)</li>
<li>User environment (e.g., file system, terminal)</li>
</ul>
<h2 id="how-mcp-works">How MCP Works<a class="td-heading-self-link" href="#how-mcp-works" aria-label="Heading self-link"></a></h2>
<p>At its core, MCP is a protocol based on JSON-RPC that enables bidirectional communication between LLMs and tools. The basic workflow is:</p>
<ol>
<li>The LLM generates a call to a tool with specific parameters</li>
<li>The host intercepts this call and routes it to the appropriate tool</li>
<li>The tool executes the requested action and returns the result</li>
<li>The result is injected into the model&rsquo;s context</li>
<li>The model continues generating a response incorporating the new information</li>
</ol>
<p>The protocol specifies:</p>
<ul>
<li>How tools declare their capabilities and parameters</li>
<li>How the model requests tool actions</li>
<li>How tools return results or errors</li>
<li>How multiple tools can be combined</li>
</ul>
<h2 id="mcp-in-gomcptest">MCP in gomcptest<a class="td-heading-self-link" href="#mcp-in-gomcptest" aria-label="Heading self-link"></a></h2>
<p>In gomcptest, MCP is implemented using a set of independent executables that communicate over standard I/O. This approach has several advantages:</p>
<ul>
<li><strong>Language-agnostic</strong>: Tools can be written in any programming language</li>
<li><strong>Process isolation</strong>: Each tool runs in its own process for security and stability</li>
<li><strong>Compatibility</strong>: The protocol works with various LLM providers</li>
<li><strong>Extensibility</strong>: New tools can be easily added to the system</li>
</ul>
<p>Each tool in gomcptest follows a consistent pattern:</p>
<ol>
<li>It receives a JSON request on stdin</li>
<li>It parses the parameters and performs its action</li>
<li>It formats the result as JSON and returns it on stdout</li>
</ol>
<h2 id="the-protocol-specification">The Protocol Specification<a class="td-heading-self-link" href="#the-protocol-specification" aria-label="Heading self-link"></a></h2>
<p>The core MCP protocol in gomcptest follows this format:</p>
<h3 id="tool-registration">Tool Registration<a class="td-heading-self-link" href="#tool-registration" aria-label="Heading self-link"></a></h3>
<p>Tools register themselves with a schema that defines their capabilities:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ToolName&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Description of what the tool does&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;parameters&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;object&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;properties&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;param1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;string&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Description of parameter 1&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;param2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;number&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;description&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Description of parameter 2&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;required&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;param1&#34;</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="function-call-request">Function Call Request<a class="td-heading-self-link" href="#function-call-request" aria-label="Heading self-link"></a></h3>
<p>When a model wants to use a tool, it generates a function call like:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ToolName&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;params&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;param1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;param2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">42</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="function-call-response">Function Call Response<a class="td-heading-self-link" href="#function-call-response" aria-label="Heading self-link"></a></h3>
<p>The tool executes the requested action and returns:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;result&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Output of the tool&#39;s execution&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Or, in case of an error:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;error&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Error message&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;code&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ERROR_CODE&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="design-decisions-in-mcp">Design Decisions in MCP<a class="td-heading-self-link" href="#design-decisions-in-mcp" aria-label="Heading self-link"></a></h2>
<p>Several key design decisions shape the MCP implementation in gomcptest:</p>
<h3 id="standard-io-communication">Standard I/O Communication<a class="td-heading-self-link" href="#standard-io-communication" aria-label="Heading self-link"></a></h3>
<p>By using stdin/stdout for communication, tools can be written in any language that can read from stdin and write to stdout. This makes it easy to integrate existing utilities and libraries.</p>
<h3 id="json-schema-for-tool-definition">JSON Schema for Tool Definition<a class="td-heading-self-link" href="#json-schema-for-tool-definition" aria-label="Heading self-link"></a></h3>
<p>Using JSON Schema for tool definitions provides a clear contract between the model and the tools. It enables:</p>
<ul>
<li>Validation of parameters</li>
<li>Documentation of capabilities</li>
<li>Potential for automatic code generation</li>
</ul>
<h3 id="stateless-design">Stateless Design<a class="td-heading-self-link" href="#stateless-design" aria-label="Heading self-link"></a></h3>
<p>Tools are designed to be stateless, with each invocation being independent. This simplifies the protocol and makes tools easier to reason about and test.</p>
<h3 id="pass-through-authentication">Pass-through Authentication<a class="td-heading-self-link" href="#pass-through-authentication" aria-label="Heading self-link"></a></h3>
<p>The protocol doesn&rsquo;t handle authentication directly; instead, it relies on the host to manage permissions and authentication. This separation of concerns keeps the protocol simple.</p>
<h2 id="comparison-with-alternatives">Comparison with Alternatives<a class="td-heading-self-link" href="#comparison-with-alternatives" aria-label="Heading self-link"></a></h2>
<h3 id="vs-openai-function-calling">vs. OpenAI Function Calling<a class="td-heading-self-link" href="#vs-openai-function-calling" aria-label="Heading self-link"></a></h3>
<p>MCP is similar to OpenAI&rsquo;s function calling feature but with these key differences:</p>
<ul>
<li>MCP is designed to be provider-agnostic</li>
<li>MCP tools run as separate processes</li>
<li>MCP provides more detailed error handling</li>
</ul>
<h3 id="vs-langchain-tools">vs. LangChain Tools<a class="td-heading-self-link" href="#vs-langchain-tools" aria-label="Heading self-link"></a></h3>
<p>Compared to LangChain:</p>
<ul>
<li>MCP is a lower-level protocol rather than a framework</li>
<li>MCP focuses on interoperability rather than abstraction</li>
<li>MCP allows for stronger process isolation</li>
</ul>
<h3 id="vs-agent-protocols">vs. Agent Protocols<a class="td-heading-self-link" href="#vs-agent-protocols" aria-label="Heading self-link"></a></h3>
<p>Other agent protocols often focus on higher-level concepts like goals and planning, while MCP focuses specifically on the mechanics of tool invocation.</p>
<h2 id="future-directions">Future Directions<a class="td-heading-self-link" href="#future-directions" aria-label="Heading self-link"></a></h2>
<p>The MCP protocol in gomcptest could evolve in several ways:</p>
<ul>
<li><strong>Enhanced security</strong>: More granular permissions and sand-boxing</li>
<li><strong>Streaming responses</strong>: Support for tools that produce incremental results</li>
<li><strong>Bidirectional communication</strong>: Supporting tools that can request clarification</li>
<li><strong>Tool composition</strong>: First-class support for chaining tools together</li>
<li><strong>State management</strong>: Optional session state for tools that need to maintain context</li>
</ul>
<h2 id="conclusion">Conclusion<a class="td-heading-self-link" href="#conclusion" aria-label="Heading self-link"></a></h2>
<p>The Model Context Protocol as implemented in gomcptest represents a pragmatic approach to extending LLM capabilities through external tools. Its simplicity, extensibility, and focus on interoperability make it a solid foundation for building and experimenting with agentic systems.</p>
<p>By understanding the protocol, developers can create new tools that seamlessly integrate with the system, unlocking new capabilities for LLM applications.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ec0891f28a646da37c980769da51b225">4.3 - Event System Architecture</h1>
    <div class="lead">Understanding the event-driven architecture that enables real-time tool interaction monitoring and streaming responses in gomcptest.</div>
	

<div class="pageinfo pageinfo-primary">
<p>This document explains the foundational event system architecture in gomcptest that enables real-time monitoring of tool interactions, streaming responses, and transparent agentic workflows. This system is implemented across different components and interfaces, with AgentFlow being one specific implementation.</p>

</div>

<h2 id="what-is-the-event-system">What is the Event System?<a class="td-heading-self-link" href="#what-is-the-event-system" aria-label="Heading self-link"></a></h2>
<p>The event system in gomcptest is a foundational architecture that provides real-time visibility into the agentic process. It captures, streams, and presents events that occur during AI-tool interactions, enabling transparency and monitoring of how AI agents make decisions and execute tasks.</p>
<p>The event system is designed as a general-purpose mechanism that can be implemented by different interfaces and components, not tied to any specific UI or implementation.</p>
<h2 id="core-event-concepts">Core Event Concepts<a class="td-heading-self-link" href="#core-event-concepts" aria-label="Heading self-link"></a></h2>
<h3 id="event-driven-transparency">Event-Driven Transparency<a class="td-heading-self-link" href="#event-driven-transparency" aria-label="Heading self-link"></a></h3>
<p>Traditional AI interactions are often &ldquo;black boxes&rdquo; where users see only the final result. The gomcptest event system provides transparency by exposing:</p>
<ol>
<li><strong>Tool Call Events</strong>: When the AI decides to use a tool, what tool it chooses, and what parameters it passes</li>
<li><strong>Tool Response Events</strong>: The results returned by tools, including success responses and error conditions</li>
<li><strong>Processing Events</strong>: Internal state changes and decision points during request processing</li>
<li><strong>Stream Events</strong>: Real-time updates as responses are generated</li>
</ol>
<h3 id="event-types">Event Types<a class="td-heading-self-link" href="#event-types" aria-label="Heading self-link"></a></h3>
<p>The system defines several core event types:</p>
<h4 id="tool-interaction-events">Tool Interaction Events<a class="td-heading-self-link" href="#tool-interaction-events" aria-label="Heading self-link"></a></h4>
<ul>
<li><strong>Tool Call Events</strong>: Capture when an AI decides to invoke a tool</li>
<li><strong>Tool Response Events</strong>: Capture the results of tool execution</li>
<li><strong>Tool Error Events</strong>: Capture failures and error conditions</li>
</ul>
<h4 id="system-events">System Events<a class="td-heading-self-link" href="#system-events" aria-label="Heading self-link"></a></h4>
<ul>
<li><strong>Stream Start/End Events</strong>: Mark the beginning and end of streaming responses</li>
<li><strong>Processing Events</strong>: Internal state changes and milestones</li>
<li><strong>Error Events</strong>: System-level errors and exceptions</li>
</ul>
<h4 id="content-events">Content Events<a class="td-heading-self-link" href="#content-events" aria-label="Heading self-link"></a></h4>
<ul>
<li><strong>Content Generation Events</strong>: Incremental content as it&rsquo;s generated</li>
<li><strong>Content Completion Events</strong>: Final content delivery</li>
<li><strong>Content Metadata Events</strong>: Information about content characteristics</li>
</ul>
<h2 id="event-architecture-patterns">Event Architecture Patterns<a class="td-heading-self-link" href="#event-architecture-patterns" aria-label="Heading self-link"></a></h2>
<h3 id="producer-consumer-model">Producer-Consumer Model<a class="td-heading-self-link" href="#producer-consumer-model" aria-label="Heading self-link"></a></h3>
<p>The event system follows a producer-consumer pattern:</p>
<ol>
<li><strong>Event Producers</strong>: Components that generate events (chat engines, tool executors, stream processors)</li>
<li><strong>Event Channels</strong>: Transport mechanisms for event delivery (Go channels, HTTP streams)</li>
<li><strong>Event Consumers</strong>: Components that process and present events (web interfaces, logging systems, monitors)</li>
</ol>
<h3 id="channel-based-streaming">Channel-Based Streaming<a class="td-heading-self-link" href="#channel-based-streaming" aria-label="Heading self-link"></a></h3>
<p>Events are delivered through channel-based streaming:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">StreamEvent</span> <span style="color:#204a87;font-weight:bold">interface</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">IsStreamEvent</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">bool</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Event channel returned by streaming operations
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">SendStreamingRequest</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&lt;-</span><span style="color:#204a87;font-weight:bold">chan</span> <span style="color:#000">StreamEvent</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">error</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">eventChan</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">chan</span> <span style="color:#000">StreamEvent</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Events are sent to the channel as they occur
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">go</span> <span style="color:#204a87;font-weight:bold">func</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">defer</span> <span style="color:#204a87">close</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">eventChan</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Generate and send events
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#000">eventChan</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">ToolCallEvent</span><span style="color:#000;font-weight:bold">{</span><span style="color:#ce5c00;font-weight:bold">...</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">eventChan</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">ToolResponseEvent</span><span style="color:#000;font-weight:bold">{</span><span style="color:#ce5c00;font-weight:bold">...</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">eventChan</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">ContentEvent</span><span style="color:#000;font-weight:bold">{</span><span style="color:#ce5c00;font-weight:bold">...</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}()</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">eventChan</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="event-metadata">Event Metadata<a class="td-heading-self-link" href="#event-metadata" aria-label="Heading self-link"></a></h3>
<p>Each event carries standardized metadata:</p>
<ul>
<li><strong>Timestamp</strong>: When the event occurred</li>
<li><strong>Event ID</strong>: Unique identifier for tracking</li>
<li><strong>Event Type</strong>: Category and specific type</li>
<li><strong>Context</strong>: Related session, request, or operation context</li>
<li><strong>Payload</strong>: Event-specific data</li>
</ul>
<h2 id="event-flow-patterns">Event Flow Patterns<a class="td-heading-self-link" href="#event-flow-patterns" aria-label="Heading self-link"></a></h2>
<h3 id="request-response-with-events">Request-Response with Events<a class="td-heading-self-link" href="#request-response-with-events" aria-label="Heading self-link"></a></h3>
<p>Traditional request-response patterns are enhanced with event streaming:</p>
<ol>
<li><strong>Request Initiated</strong>: System generates start events</li>
<li><strong>Processing Events</strong>: Intermediate steps generate progress events</li>
<li><strong>Tool Interactions</strong>: Tool calls and responses generate events</li>
<li><strong>Content Generation</strong>: Streaming content generates incremental events</li>
<li><strong>Completion</strong>: Final response and end events</li>
</ol>
<h3 id="event-correlation">Event Correlation<a class="td-heading-self-link" href="#event-correlation" aria-label="Heading self-link"></a></h3>
<p>Events are correlated through:</p>
<ul>
<li><strong>Session IDs</strong>: Grouping events within a single chat session</li>
<li><strong>Request IDs</strong>: Linking events to specific API requests</li>
<li><strong>Tool Call IDs</strong>: Connecting tool call and response events</li>
<li><strong>Parent-Child Relationships</strong>: Hierarchical event relationships</li>
</ul>
<h2 id="implementation-patterns">Implementation Patterns<a class="td-heading-self-link" href="#implementation-patterns" aria-label="Heading self-link"></a></h2>
<h3 id="server-sent-events-sse">Server-Sent Events (SSE)<a class="td-heading-self-link" href="#server-sent-events-sse" aria-label="Heading self-link"></a></h3>
<p>For web interfaces, events are delivered via Server-Sent Events:</p>
<pre tabindex="0"><code>event: tool_call
data: {&#34;id&#34;: &#34;call_123&#34;, &#34;name&#34;: &#34;Edit&#34;, &#34;arguments&#34;: {...}}

event: tool_response  
data: {&#34;id&#34;: &#34;call_123&#34;, &#34;result&#34;: &#34;File updated successfully&#34;}

event: content_delta
data: {&#34;delta&#34;: &#34;The file has been updated as requested.&#34;}
</code></pre><h3 id="json-rpc-event-extensions">JSON-RPC Event Extensions<a class="td-heading-self-link" href="#json-rpc-event-extensions" aria-label="Heading self-link"></a></h3>
<p>For programmatic interfaces, events extend the JSON-RPC protocol:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;jsonrpc&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2.0&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;method&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;event&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;params&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;event_type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;tool_call&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;event_data&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;id&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;call_123&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;name&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Edit&#34;</span><span style="color:#000;font-weight:bold">,</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;arguments&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#a40000">...</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="event-processing-strategies">Event Processing Strategies<a class="td-heading-self-link" href="#event-processing-strategies" aria-label="Heading self-link"></a></h2>
<h3 id="real-time-processing">Real-Time Processing<a class="td-heading-self-link" href="#real-time-processing" aria-label="Heading self-link"></a></h3>
<p>Events are processed as they occur:</p>
<ul>
<li><strong>Immediate Display</strong>: Critical events are shown immediately</li>
<li><strong>Progressive Enhancement</strong>: UI updates incrementally as events arrive</li>
<li><strong>Optimistic Updates</strong>: UI shows intended state before confirmation</li>
</ul>
<h3 id="buffering-and-batching">Buffering and Batching<a class="td-heading-self-link" href="#buffering-and-batching" aria-label="Heading self-link"></a></h3>
<p>For performance optimization:</p>
<ul>
<li><strong>Event Buffering</strong>: Collect multiple events before processing</li>
<li><strong>Batch Updates</strong>: Update UI with multiple events simultaneously</li>
<li><strong>Debouncing</strong>: Reduce update frequency for high-frequency events</li>
</ul>
<h3 id="error-handling">Error Handling<a class="td-heading-self-link" href="#error-handling" aria-label="Heading self-link"></a></h3>
<p>Robust error handling in event processing:</p>
<ul>
<li><strong>Graceful Degradation</strong>: Continue operation when non-critical events fail</li>
<li><strong>Event Recovery</strong>: Attempt to recover from event processing errors</li>
<li><strong>Fallback Modes</strong>: Alternative processing when event system fails</li>
</ul>
<h2 id="event-system-benefits">Event System Benefits<a class="td-heading-self-link" href="#event-system-benefits" aria-label="Heading self-link"></a></h2>
<h3 id="observability">Observability<a class="td-heading-self-link" href="#observability" aria-label="Heading self-link"></a></h3>
<p>The event system provides comprehensive observability:</p>
<ul>
<li><strong>Real-Time Monitoring</strong>: See what&rsquo;s happening as it happens</li>
<li><strong>Historical Analysis</strong>: Review past interactions and decisions</li>
<li><strong>Performance Insights</strong>: Understand timing and bottlenecks</li>
<li><strong>Error Tracking</strong>: Identify and diagnose issues</li>
</ul>
<h3 id="user-experience">User Experience<a class="td-heading-self-link" href="#user-experience" aria-label="Heading self-link"></a></h3>
<p>Enhanced user experience through transparency:</p>
<ul>
<li><strong>Progress Indication</strong>: Users see incremental progress</li>
<li><strong>Decision Transparency</strong>: Understand AI reasoning process</li>
<li><strong>Interactive Feedback</strong>: Respond to tool executions in real-time</li>
<li><strong>Learning Opportunity</strong>: Understand how AI approaches problems</li>
</ul>
<h3 id="development-and-debugging">Development and Debugging<a class="td-heading-self-link" href="#development-and-debugging" aria-label="Heading self-link"></a></h3>
<p>Valuable for development:</p>
<ul>
<li><strong>Debugging Aid</strong>: Trace execution flow and identify issues</li>
<li><strong>Testing Support</strong>: Verify expected event sequences</li>
<li><strong>Performance Analysis</strong>: Identify optimization opportunities</li>
<li><strong>Integration Testing</strong>: Validate event handling across components</li>
</ul>
<h2 id="integration-points">Integration Points<a class="td-heading-self-link" href="#integration-points" aria-label="Heading self-link"></a></h2>
<h3 id="chat-engines">Chat Engines<a class="td-heading-self-link" href="#chat-engines" aria-label="Heading self-link"></a></h3>
<p>Chat engines integrate with the event system by:</p>
<ul>
<li>Generating tool call events when invoking tools</li>
<li>Emitting content events during response generation</li>
<li>Providing processing events for transparency</li>
<li>Handling event delivery through streaming channels</li>
</ul>
<h3 id="tool-executors">Tool Executors<a class="td-heading-self-link" href="#tool-executors" aria-label="Heading self-link"></a></h3>
<p>Tools integrate by:</p>
<ul>
<li>Emitting execution start events</li>
<li>Providing progress updates for long-running operations</li>
<li>Returning detailed response events</li>
<li>Generating error events with diagnostic information</li>
</ul>
<h3 id="user-interfaces">User Interfaces<a class="td-heading-self-link" href="#user-interfaces" aria-label="Heading self-link"></a></h3>
<p>Interfaces integrate by:</p>
<ul>
<li>Subscribing to event streams</li>
<li>Processing events in real-time</li>
<li>Updating UI based on event content</li>
<li>Providing user controls for event display</li>
</ul>
<h2 id="event-system-implementations">Event System Implementations<a class="td-heading-self-link" href="#event-system-implementations" aria-label="Heading self-link"></a></h2>
<p>The event system is a general architecture that can be implemented in various ways:</p>
<h3 id="agentflow-web-interface">AgentFlow Web Interface<a class="td-heading-self-link" href="#agentflow-web-interface" aria-label="Heading self-link"></a></h3>
<p>AgentFlow implements the event system through:</p>
<ul>
<li>Browser-based SSE consumption</li>
<li>Real-time popup notifications for tool calls</li>
<li>Progressive content updates</li>
<li>Interactive event display controls</li>
</ul>
<h3 id="cli-interfaces">CLI Interfaces<a class="td-heading-self-link" href="#cli-interfaces" aria-label="Heading self-link"></a></h3>
<p>Command-line interfaces can implement through:</p>
<ul>
<li>Terminal-based event display</li>
<li>Progress indicators and status updates</li>
<li>Structured logging of events</li>
<li>Interactive prompts based on events</li>
</ul>
<h3 id="api-gateways">API Gateways<a class="td-heading-self-link" href="#api-gateways" aria-label="Heading self-link"></a></h3>
<p>API gateways can implement through:</p>
<ul>
<li>Event forwarding to multiple consumers</li>
<li>Event filtering and transformation</li>
<li>Event persistence and replay</li>
<li>Event-based routing and load balancing</li>
</ul>
<h2 id="future-event-system-enhancements">Future Event System Enhancements<a class="td-heading-self-link" href="#future-event-system-enhancements" aria-label="Heading self-link"></a></h2>
<h3 id="advanced-event-types">Advanced Event Types<a class="td-heading-self-link" href="#advanced-event-types" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>Reasoning Events</strong>: Capture AI&rsquo;s internal reasoning process</li>
<li><strong>Planning Events</strong>: Show multi-step planning and strategy</li>
<li><strong>Context Events</strong>: Track context usage and management</li>
<li><strong>Performance Events</strong>: Detailed timing and resource usage</li>
</ul>
<h3 id="event-intelligence">Event Intelligence<a class="td-heading-self-link" href="#event-intelligence" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>Event Pattern Recognition</strong>: Identify common patterns and anomalies</li>
<li><strong>Predictive Events</strong>: Anticipate likely next events</li>
<li><strong>Event Summarization</strong>: Aggregate events into higher-level insights</li>
<li><strong>Event Recommendations</strong>: Suggest optimizations based on event patterns</li>
</ul>
<h3 id="enhanced-delivery">Enhanced Delivery<a class="td-heading-self-link" href="#enhanced-delivery" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>Event Persistence</strong>: Store and replay event histories</li>
<li><strong>Event Filtering</strong>: Selective event delivery based on preferences</li>
<li><strong>Event Routing</strong>: Direct events to multiple consumers</li>
<li><strong>Event Transformation</strong>: Adapt events for different consumer types</li>
</ul>
<h2 id="conclusion">Conclusion<a class="td-heading-self-link" href="#conclusion" aria-label="Heading self-link"></a></h2>
<p>The event system architecture in gomcptest provides a foundational layer for transparency, observability, and real-time interaction in agentic systems. By understanding these concepts, developers can effectively implement event-driven interfaces, create monitoring systems, and build tools that provide deep visibility into AI agent behavior.</p>
<p>This event system is implementation-agnostic and serves as the foundation for specific implementations like AgentFlow, while also enabling other interfaces and monitoring systems to provide similar transparency and real-time feedback capabilities.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dfb825df92428ce7ba378cf65f53a5ca">4.4 - Understanding the MCP Tools</h1>
    <div class="lead">Detailed explanation of the MCP tools architecture and implementation</div>
	

<div class="pageinfo pageinfo-primary">
<p>This document explains the architecture and implementation of the MCP tools in gomcptest, how they work, and the design principles behind them.</p>

</div>

<h2 id="what-are-mcp-tools">What are MCP Tools?<a class="td-heading-self-link" href="#what-are-mcp-tools" aria-label="Heading self-link"></a></h2>
<p>MCP (Model Context Protocol) tools are standalone executables that provide specific functions that can be invoked by AI models. They allow the AI to interact with its environment - performing tasks like reading and writing files, executing commands, or searching for information.</p>
<p>In gomcptest, tools are implemented as independent Go executables that follow a standard protocol for receiving requests and returning results through standard input/output streams. Tool interactions generate events that are captured by the <a href="../event-system/">event system</a>, enabling real-time monitoring and transparency.</p>
<h2 id="tool-architecture">Tool Architecture<a class="td-heading-self-link" href="#tool-architecture" aria-label="Heading self-link"></a></h2>
<p>Each tool in gomcptest follows a consistent architecture:</p>
<ol>
<li><strong>Standard I/O Interface</strong>: Tools communicate via stdin/stdout using JSON-formatted requests and responses</li>
<li><strong>Parameter Validation</strong>: Tools validate their input parameters according to a JSON schema</li>
<li><strong>Stateless Execution</strong>: Each tool invocation is independent and does not maintain state</li>
<li><strong>Controlled Access</strong>: Tools implement appropriate security measures and permission checks</li>
<li><strong>Structured Results</strong>: Results are returned in a standardized JSON format</li>
</ol>
<h3 id="common-components">Common Components<a class="td-heading-self-link" href="#common-components" aria-label="Heading self-link"></a></h3>
<p>Most tools share these common components:</p>
<ul>
<li><strong>Main Function</strong>: Parses JSON input, validates parameters, executes the core function, formats and returns the result</li>
<li><strong>Parameter Structure</strong>: Defines the expected input parameters for the tool</li>
<li><strong>Result Structure</strong>: Defines the format of the tool&rsquo;s output</li>
<li><strong>Error Handling</strong>: Standardized error reporting and handling</li>
<li><strong>Security Checks</strong>: Validation to prevent dangerous operations</li>
</ul>
<h2 id="tool-categories">Tool Categories<a class="td-heading-self-link" href="#tool-categories" aria-label="Heading self-link"></a></h2>
<p>The tools in gomcptest can be categorized into several functional groups:</p>
<h3 id="filesystem-navigation">Filesystem Navigation<a class="td-heading-self-link" href="#filesystem-navigation" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>LS</strong>: Lists files and directories, providing metadata and structure</li>
<li><strong>GlobTool</strong>: Finds files matching specific patterns, making it easier to locate relevant files</li>
<li><strong>GrepTool</strong>: Searches file contents using regular expressions, helping find specific information in codebases</li>
</ul>
<h3 id="content-management">Content Management<a class="td-heading-self-link" href="#content-management" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>View</strong>: Reads and displays file contents, allowing the model to analyze existing code or documentation</li>
<li><strong>Edit</strong>: Makes targeted modifications to files, enabling precise changes without overwriting the entire file</li>
<li><strong>Replace</strong>: Completely overwrites file contents, useful for generating new files or making major changes</li>
</ul>
<h3 id="system-interaction">System Interaction<a class="td-heading-self-link" href="#system-interaction" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>Bash</strong>: Executes shell commands, allowing the model to run commands, scripts, and programs</li>
<li><strong>dispatch_agent</strong>: A meta-tool that can create specialized sub-agents for specific tasks</li>
</ul>
<h3 id="aiml-services">AI/ML Services<a class="td-heading-self-link" href="#aiml-services" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>imagen</strong>: Generates and manipulates images using Google&rsquo;s Imagen API, enabling visual content creation</li>
</ul>
<h3 id="data-processing">Data Processing<a class="td-heading-self-link" href="#data-processing" aria-label="Heading self-link"></a></h3>
<ul>
<li><strong>duckdbserver</strong>: Provides SQL-based data processing capabilities using DuckDB, enabling complex data analysis and transformations</li>
</ul>
<h2 id="design-principles">Design Principles<a class="td-heading-self-link" href="#design-principles" aria-label="Heading self-link"></a></h2>
<p>The tools in gomcptest were designed with several key principles in mind:</p>
<h3 id="1-modularity">1. Modularity<a class="td-heading-self-link" href="#1-modularity" aria-label="Heading self-link"></a></h3>
<p>Each tool is a standalone executable that can be developed, tested, and deployed independently. This modular approach allows for:</p>
<ul>
<li>Independent development cycles</li>
<li>Targeted testing</li>
<li>Simpler debugging</li>
<li>Ability to add or replace tools without affecting the entire system</li>
</ul>
<h3 id="2-security">2. Security<a class="td-heading-self-link" href="#2-security" aria-label="Heading self-link"></a></h3>
<p>Security is a major consideration in the tool design:</p>
<ul>
<li>Tools validate inputs to prevent injection attacks</li>
<li>File operations are limited to appropriate directories</li>
<li>Bash command execution is restricted with banned commands</li>
<li>Timeouts prevent infinite operations</li>
<li>Process isolation prevents one tool from affecting others</li>
</ul>
<h3 id="3-simplicity">3. Simplicity<a class="td-heading-self-link" href="#3-simplicity" aria-label="Heading self-link"></a></h3>
<p>The tools are designed to be simple to understand and use:</p>
<ul>
<li>Clear, focused functionality for each tool</li>
<li>Straightforward parameter structures</li>
<li>Consistent result formats</li>
<li>Well-documented behaviors and limitations</li>
</ul>
<h3 id="4-extensibility">4. Extensibility<a class="td-heading-self-link" href="#4-extensibility" aria-label="Heading self-link"></a></h3>
<p>The system is designed to be easily extended:</p>
<ul>
<li>New tools can be added by following the standard protocol</li>
<li>Existing tools can be enhanced with additional parameters</li>
<li>Alternative implementations can replace existing tools</li>
</ul>
<h2 id="tool-protocol-details">Tool Protocol Details<a class="td-heading-self-link" href="#tool-protocol-details" aria-label="Heading self-link"></a></h2>
<p>The communication protocol for tools follows this pattern:</p>
<h3 id="input-format">Input Format<a class="td-heading-self-link" href="#input-format" aria-label="Heading self-link"></a></h3>
<p>Tools receive JSON input on stdin in this format:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;param1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value1&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;param2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value2&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;param3&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">123</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="output-format">Output Format<a class="td-heading-self-link" href="#output-format" aria-label="Heading self-link"></a></h3>
<p>Tools return JSON output on stdout in one of these formats:</p>
<h4 id="success">Success:<a class="td-heading-self-link" href="#success" aria-label="Heading self-link"></a></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;result&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;text result&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;results&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;field1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value1&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;field2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value2&#34;</span><span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;field1&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value3&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">&#34;field2&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;value4&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="error">Error:<a class="td-heading-self-link" href="#error" aria-label="Heading self-link"></a></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;error&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Error message&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;code&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ERROR_CODE&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="implementation-examples">Implementation Examples<a class="td-heading-self-link" href="#implementation-examples" aria-label="Heading self-link"></a></h2>
<h3 id="basic-tool-structure">Basic Tool Structure<a class="td-heading-self-link" href="#basic-tool-structure" aria-label="Heading self-link"></a></h3>
<p>Most tools follow this basic structure:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">package</span> <span style="color:#000">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>	<span style="color:#4e9a06">&#34;encoding/json&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#4e9a06">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#4e9a06">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Parameters defines the expected input structure
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">Parameters</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Param1</span> <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`json:&#34;param1&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Param2</span> <span style="color:#204a87;font-weight:bold">int</span>    <span style="color:#4e9a06">`json:&#34;param2,omitempty&#34;`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Result defines the output structure
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">Result</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Result</span>  <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`json:&#34;result,omitempty&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Error</span>   <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`json:&#34;error,omitempty&#34;`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">Code</span>    <span style="color:#204a87;font-weight:bold">string</span> <span style="color:#4e9a06">`json:&#34;code,omitempty&#34;`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Parse input
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">params</span> <span style="color:#000">Parameters</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">decoder</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">NewDecoder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">os</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Stdin</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">decoder</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Decode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">params</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">outputError</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Failed to parse input&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;INVALID_INPUT&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">return</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Validate parameters
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">params</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Param1</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#34;&#34;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">outputError</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;param1 is required&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;MISSING_PARAMETER&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">return</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Execute core functionality
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">result</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">executeTool</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">params</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">err</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">outputError</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">err</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Error</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#4e9a06">&#34;EXECUTION_ERROR&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#204a87;font-weight:bold">return</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Return result
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#000">output</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">Result</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">Result</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">result</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">encoder</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">NewEncoder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">os</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Stdout</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">encoder</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Encode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">output</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">executeTool</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">params</span> <span style="color:#000">Parameters</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">error</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#8f5902;font-style:italic">// Tool-specific logic here
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>	<span style="color:#204a87;font-weight:bold">return</span> <span style="color:#4e9a06">&#34;result&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000">outputError</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">message</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">code</span> <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">Result</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">Error</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">message</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">Code</span><span style="color:#000;font-weight:bold">:</span>  <span style="color:#000">code</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">encoder</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">NewEncoder</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">os</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Stdout</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">encoder</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Encode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">result</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="advanced-concepts">Advanced Concepts<a class="td-heading-self-link" href="#advanced-concepts" aria-label="Heading self-link"></a></h2>
<h3 id="tool-composition">Tool Composition<a class="td-heading-self-link" href="#tool-composition" aria-label="Heading self-link"></a></h3>
<p>The dispatch_agent tool demonstrates how tools can be composed to create more powerful capabilities. It:</p>
<ol>
<li>Accepts a high-level task description</li>
<li>Plans a sequence of tool operations to accomplish the task</li>
<li>Executes these operations using the available tools</li>
<li>Synthesizes the results into a coherent response</li>
</ol>
<h3 id="error-propagation">Error Propagation<a class="td-heading-self-link" href="#error-propagation" aria-label="Heading self-link"></a></h3>
<p>The tool error mechanism is designed to provide useful information back to the model:</p>
<ul>
<li>Error messages are human-readable and descriptive</li>
<li>Error codes allow programmatic handling of specific error types</li>
<li>Stacktraces and debugging information are not exposed to maintain security</li>
</ul>
<h3 id="performance-considerations">Performance Considerations<a class="td-heading-self-link" href="#performance-considerations" aria-label="Heading self-link"></a></h3>
<p>Tools are designed with performance in mind:</p>
<ul>
<li>File operations use efficient libraries and patterns</li>
<li>Search operations employ indexing and filtering when appropriate</li>
<li>Large results can be paginated or truncated to prevent context overflows</li>
<li>Resource-intensive operations have configurable timeouts</li>
</ul>
<h2 id="future-directions">Future Directions<a class="td-heading-self-link" href="#future-directions" aria-label="Heading self-link"></a></h2>
<p>The tool architecture in gomcptest could evolve in several ways:</p>
<ol>
<li><strong>Streaming Results</strong>: Supporting incremental results for long-running operations</li>
<li><strong>Tool Discovery</strong>: More sophisticated mechanisms for models to discover available tools</li>
<li><strong>Tool Chaining</strong>: First-class support for composing multiple tools in sequences or pipelines</li>
<li><strong>Interactive Tools</strong>: Tools that can engage in multi-step interactions with the model</li>
<li><strong>Persistent State</strong>: Optional state maintenance for tools that benefit from context</li>
</ol>
<h2 id="conclusion">Conclusion<a class="td-heading-self-link" href="#conclusion" aria-label="Heading self-link"></a></h2>
<p>The MCP tools in gomcptest provide a flexible, secure, and extensible foundation for enabling AI agents to interact with their environment. By understanding the architecture and design principles of these tools, developers can effectively utilize the existing tools, extend them with new capabilities, or create entirely new tools that integrate seamlessly with the system.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cc9d8f3effc7306c99038e88b638b5a1">4.5 - AgentFlow: Event-Driven Interface Implementation</h1>
    <div class="lead">Implementation details of AgentFlow&rsquo;s event-driven web interface, demonstrating how the general event system concepts are applied in practice through real-time tool interactions and streaming responses.</div>
	<p>This document explains how AgentFlow implements the general <a href="../event-system/">event system architecture</a> in a web-based interface, providing a concrete example of the event-driven patterns described in the foundational concepts. AgentFlow is the embedded web interface for gomcptest&rsquo;s OpenAI-compatible server.</p>
<h2 id="what-is-agentflow">What is AgentFlow?<a class="td-heading-self-link" href="#what-is-agentflow" aria-label="Heading self-link"></a></h2>
<p>AgentFlow is a specific implementation of the gomcptest <a href="../event-system/">event system</a> in the form of a modern web-based chat interface. It demonstrates how the general event-driven architecture can be applied to create transparent, real-time agentic interactions through a browser-based UI.</p>
<h2 id="core-architecture-overview">Core Architecture Overview<a class="td-heading-self-link" href="#core-architecture-overview" aria-label="Heading self-link"></a></h2>
<h3 id="chatengine-interface-design">ChatEngine Interface Design<a class="td-heading-self-link" href="#chatengine-interface-design" aria-label="Heading self-link"></a></h3>
<p>The foundation of AgentFlow&rsquo;s functionality rests on the <code>ChatServer</code> interface defined in <code>chatengine/chat_server.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">ChatServer</span> <span style="color:#204a87;font-weight:bold">interface</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">AddMCPTool</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">client</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">MCPClient</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">error</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ModelList</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Context</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">ListModelsResponse</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ModelDetail</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ctx</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Context</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">modelID</span> <span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">Model</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ListTools</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">ctx</span> <span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Context</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#000">ListToolResponse</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">HandleCompletionRequest</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Context</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ChatCompletionRequest</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ChatCompletionResponse</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">error</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">SendStreamingChatRequest</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">context</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Context</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ChatCompletionRequest</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">&lt;-</span><span style="color:#204a87;font-weight:bold">chan</span> <span style="color:#000">StreamEvent</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">error</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>This interface abstracts the underlying LLM provider (currently Vertex AI Gemini) and provides a consistent API for tool integration and streaming responses. The key innovation is the <code>SendStreamingChatRequest</code> method that returns a channel of <code>StreamEvent</code> interfaces, enabling real-time event streaming.</p>
<h3 id="openai-v1-api-compatibility-strategy">OpenAI v1 API Compatibility Strategy<a class="td-heading-self-link" href="#openai-v1-api-compatibility-strategy" aria-label="Heading self-link"></a></h3>
<p>A fundamental design decision was to maintain full compatibility with the OpenAI v1 API while extending it with enhanced functionality. This is achieved through:</p>
<ol>
<li><strong>Standard Endpoint Preservation</strong>: Uses <code>/v1/chat/completions</code>, <code>/v1/models</code>, and <code>/v1/tools</code> endpoints</li>
<li><strong>Parameter Encoding</strong>: Tool selection is encoded within the existing model parameter using a pipe-delimited format</li>
<li><strong>Event Extension</strong>: Additional events are streamed alongside standard chat completion responses</li>
<li><strong>Backward Compatibility</strong>: Existing OpenAI-compatible clients work unchanged</li>
</ol>
<p>This approach avoids the need to modify standard API endpoints while providing enhanced capabilities through the AgentFlow interface.</p>
<h2 id="event-system-architecture">Event System Architecture<a class="td-heading-self-link" href="#event-system-architecture" aria-label="Heading self-link"></a></h2>
<h3 id="streamevent-interface">StreamEvent Interface<a class="td-heading-self-link" href="#streamevent-interface" aria-label="Heading self-link"></a></h3>
<p>The event system is built around the <code>StreamEvent</code> interface in <code>chatengine/stream_event.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">StreamEvent</span> <span style="color:#204a87;font-weight:bold">interface</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">IsStreamEvent</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#204a87;font-weight:bold">bool</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>This simple interface allows for polymorphic event handling, where different event types can be processed through the same streaming pipeline.</p>
<h3 id="event-types-and-structure">Event Types and Structure<a class="td-heading-self-link" href="#event-types-and-structure" aria-label="Heading self-link"></a></h3>
<h4 id="tool-call-events">Tool Call Events<a class="td-heading-self-link" href="#tool-call-events" aria-label="Heading self-link"></a></h4>
<p>Defined in <code>chatengine/vertexai/gemini/tool_events.go</code>, tool call events capture when the AI decides to use a tool:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">ToolCallEvent</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ID</span>        <span style="color:#204a87;font-weight:bold">string</span>          <span style="color:#4e9a06">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Object</span>    <span style="color:#204a87;font-weight:bold">string</span>          <span style="color:#4e9a06">`json:&#34;object&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Created</span>   <span style="color:#204a87;font-weight:bold">int64</span>           <span style="color:#4e9a06">`json:&#34;created&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">EventType</span> <span style="color:#204a87;font-weight:bold">string</span>          <span style="color:#4e9a06">`json:&#34;event_type&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ToolCall</span>  <span style="color:#000">ToolCallDetails</span> <span style="color:#4e9a06">`json:&#34;tool_call&#34;`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">ToolCallDetails</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ID</span>        <span style="color:#204a87;font-weight:bold">string</span>                 <span style="color:#4e9a06">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Name</span>      <span style="color:#204a87;font-weight:bold">string</span>                 <span style="color:#4e9a06">`json:&#34;name&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Arguments</span> <span style="color:#204a87;font-weight:bold">map</span><span style="color:#000;font-weight:bold">[</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">]</span><span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}</span> <span style="color:#4e9a06">`json:&#34;arguments&#34;`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="tool-response-events">Tool Response Events<a class="td-heading-self-link" href="#tool-response-events" aria-label="Heading self-link"></a></h4>
<p>Tool response events capture the results of tool execution:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">ToolResponseEvent</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ID</span>           <span style="color:#204a87;font-weight:bold">string</span>              <span style="color:#4e9a06">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Object</span>       <span style="color:#204a87;font-weight:bold">string</span>              <span style="color:#4e9a06">`json:&#34;object&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Created</span>      <span style="color:#204a87;font-weight:bold">int64</span>               <span style="color:#4e9a06">`json:&#34;created&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">EventType</span>    <span style="color:#204a87;font-weight:bold">string</span>              <span style="color:#4e9a06">`json:&#34;event_type&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ToolResponse</span> <span style="color:#000">ToolResponseDetails</span> <span style="color:#4e9a06">`json:&#34;tool_response&#34;`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">type</span> <span style="color:#000">ToolResponseDetails</span> <span style="color:#204a87;font-weight:bold">struct</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">ID</span>       <span style="color:#204a87;font-weight:bold">string</span>      <span style="color:#4e9a06">`json:&#34;id&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Name</span>     <span style="color:#204a87;font-weight:bold">string</span>      <span style="color:#4e9a06">`json:&#34;name&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Response</span> <span style="color:#204a87;font-weight:bold">interface</span><span style="color:#000;font-weight:bold">{}</span> <span style="color:#4e9a06">`json:&#34;response&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Error</span>    <span style="color:#204a87;font-weight:bold">string</span>      <span style="color:#4e9a06">`json:&#34;error,omitempty&#34;`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="server-sent-events-implementation">Server-Sent Events Implementation<a class="td-heading-self-link" href="#server-sent-events-implementation" aria-label="Heading self-link"></a></h3>
<p>The streaming implementation in <code>chatengine/chat_completion_stream.go</code> provides the SSE infrastructure:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">o</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">OpenAIV1WithToolHandler</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">streamResponse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">w</span> <span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ResponseWriter</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">http</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Request</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">req</span> <span style="color:#000">ChatCompletionRequest</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Content-Type&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;text/event-stream&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Cache-Control&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;no-cache&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Connection&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;keep-alive&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Header</span><span style="color:#000;font-weight:bold">().</span><span style="color:#000">Set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Transfer-Encoding&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;chunked&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Process events from the stream channel
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">event</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">stream</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">switch</span> <span style="color:#000">res</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">event</span><span style="color:#000;font-weight:bold">.(</span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#000">ChatCompletionStreamResponse</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8f5902;font-style:italic">// Handle standard chat completion chunks
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8f5902;font-style:italic">// Handle tool events if withAllEvents flag is true
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">o</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">withAllEvents</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">jsonBytes</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">_</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">json</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Marshal</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">w</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Write</span><span style="color:#000;font-weight:bold">([]</span><span style="color:#204a87">byte</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;data: &#34;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#204a87">string</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">jsonBytes</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#4e9a06">&#34;\n\n&#34;</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>The <code>withAllEvents</code> flag controls whether tool events are included in the stream, allowing for backward compatibility with standard OpenAI clients.</p>
<h2 id="model-and-tool-selection-mechanism">Model and Tool Selection Mechanism<a class="td-heading-self-link" href="#model-and-tool-selection-mechanism" aria-label="Heading self-link"></a></h2>
<h3 id="pipe-delimited-encoding">Pipe-Delimited Encoding<a class="td-heading-self-link" href="#pipe-delimited-encoding" aria-label="Heading self-link"></a></h3>
<p>The tool selection mechanism is implemented through a clever encoding scheme in the model parameter. The <code>ParseModelAndTools</code> method in <code>chatengine/chat_structure.go</code> parses this format:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">req</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ChatCompletionRequest</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">ParseModelAndTools</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">parts</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">strings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">req</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Model</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;|&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parts</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">req</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Model</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">nil</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">modelName</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">strings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TrimSpace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parts</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">toolNames</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87">make</span><span style="color:#000;font-weight:bold">([]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parts</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">;</span> <span style="color:#000">i</span> <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parts</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">++</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">toolName</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">strings</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">TrimSpace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parts</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">toolName</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#4e9a06">&#34;&#34;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">toolNames</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">toolNames</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">toolName</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">modelName</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">toolNames</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>This allows formats like:</p>
<ul>
<li><code>gemini-2.0-flash</code> (no tool filtering)</li>
<li><code>gemini-2.0-flash|Edit|View|Bash</code> (specific tools only)</li>
<li><code>gemini-1.5-pro|VertexAI Code Execution</code> (model with built-in tools)</li>
</ul>
<h3 id="tool-filtering-implementation">Tool Filtering Implementation<a class="td-heading-self-link" href="#tool-filtering-implementation" aria-label="Heading self-link"></a></h3>
<p>The Vertex AI Gemini implementation includes sophisticated tool filtering in <code>chatengine/vertexai/gemini/chatsession.go</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">func</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">chatsession</span> <span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">ChatSession</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000">FilterTools</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">requestedToolNames</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#204a87;font-weight:bold">string</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tool</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">requestedToolNames</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">chatsession</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tools</span> <span style="color:#8f5902;font-style:italic">// Return all tools if none specified
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">filteredTools</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tool</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">var</span> <span style="color:#000">filteredFunctions</span> <span style="color:#000;font-weight:bold">[]</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FunctionDeclaration</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">tool</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">chatsession</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tools</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Handle Vertex AI built-in tools separately
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">switch</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#000">tool</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CodeExecution</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#000">requestedMap</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">VERTEXAI_CODE_EXECUTION</span><span style="color:#000;font-weight:bold">]:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">filteredTools</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">filteredTools</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tool</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">CodeExecution</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">tool</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">CodeExecution</span><span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">case</span> <span style="color:#000">tool</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GoogleSearch</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87;font-weight:bold">nil</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#000">requestedMap</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">VERTEXAI_GOOGLE_SEARCH</span><span style="color:#000;font-weight:bold">]:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">filteredTools</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">filteredTools</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tool</span><span style="color:#000;font-weight:bold">{</span><span style="color:#000">GoogleSearch</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">tool</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">GoogleSearch</span><span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// ... handle other built-in tools
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#8f5902;font-style:italic">// Handle MCP function declarations
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>            <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">function</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#204a87;font-weight:bold">range</span> <span style="color:#000">tool</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">FunctionDeclarations</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">requestedMap</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">function</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Name</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">filteredFunctions</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">filteredFunctions</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">function</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Combine function declarations into a single tool
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">filteredFunctions</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">filteredTools</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#204a87">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">filteredTools</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">&amp;</span><span style="color:#000">genai</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">Tool</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">FunctionDeclarations</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000">filteredFunctions</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">filteredTools</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>This implementation handles both Vertex AI built-in tools (CodeExecution, GoogleSearch, etc.) and MCP function declarations, ensuring they are properly separated to avoid proto validation errors.</p>
<h2 id="frontend-event-processing">Frontend Event Processing<a class="td-heading-self-link" href="#frontend-event-processing" aria-label="Heading self-link"></a></h2>
<h3 id="real-time-event-handling">Real-Time Event Handling<a class="td-heading-self-link" href="#real-time-event-handling" aria-label="Heading self-link"></a></h3>
<p>The JavaScript implementation in <code>chat-ui.html.tmpl</code> provides comprehensive event processing through the <code>handleStreamingResponse</code> method:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">async</span> <span style="color:#000">handleStreamingResponse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">response</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">reader</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">response</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">body</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">getReader</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">decoder</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">TextDecoder</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">done</span> <span style="color:#000;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">await</span> <span style="color:#000">reader</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">read</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">done</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">chunk</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">decoder</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">decode</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">value</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">{</span> <span style="color:#000">stream</span><span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span> <span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">lines</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">chunk</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;\n&#39;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">line</span> <span style="color:#204a87;font-weight:bold">of</span> <span style="color:#000">lines</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">line</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">startsWith</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;data: &#39;</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">data</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">line</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">slice</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">6</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#4e9a06">&#39;[DONE]&#39;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">parsed</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">JSON</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">parse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">data</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>                    <span style="color:#8f5902;font-style:italic">// Handle different event types
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">event_type</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#4e9a06">&#39;tool_call&#39;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">addToolNotification</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tool_call</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">showToolCallPopup</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">event_type</span> <span style="color:#ce5c00;font-weight:bold">===</span> <span style="color:#4e9a06">&#39;tool_response&#39;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">updateToolResponsePopup</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">storeToolResponse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">choices</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#000">parsed</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">choices</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">])</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#8f5902;font-style:italic">// Handle standard chat completion chunks
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                        <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">updateMessageContent</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">messageIndex</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">assistantMessage</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">}</span> <span style="color:#204a87;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">e</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#8f5902;font-style:italic">// Handle JSON parse errors gracefully
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>                <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="tool-popup-management">Tool Popup Management<a class="td-heading-self-link" href="#tool-popup-management" aria-label="Heading self-link"></a></h3>
<p>AgentFlow implements a sophisticated popup management system to provide real-time feedback on tool execution:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000">showToolCallPopup</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">popupId</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">event</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tool_call</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Create popup with loading state
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">popup</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">document</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">createElement</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;div&#39;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">popup</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">className</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;tool-popup tool-call&#39;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">popup</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">innerHTML</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">`
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">        &lt;div class=&#34;tool-popup-header&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">            &lt;div class=&#34;tool-popup-title&#34;&gt;Tool Executing: </span><span style="color:#4e9a06">${</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tool_call</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">name</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">            &lt;button class=&#34;tool-popup-close&#34; onclick=&#34;chatUI.closeToolPopup(&#39;</span><span style="color:#4e9a06">${</span><span style="color:#000">popupId</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&#39;)&#34;&gt;√ó&lt;/button&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">        &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">        &lt;div class=&#34;tool-popup-content&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">            &lt;div class=&#34;tool-popup-args&#34;&gt;</span><span style="color:#4e9a06">${</span><span style="color:#000">JSON</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">stringify</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tool_call</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">arguments</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">&lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">            &lt;div class=&#34;tool-popup-spinner&#34;&gt;&lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">        &lt;/div&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06">    `</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Store reference and set auto-close timer
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">toolPopups</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">popupId</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">popup</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">popupAutoCloseTimers</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">set</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">popupId</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">setTimeout</span><span style="color:#000;font-weight:bold">(()</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">closeToolPopup</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">popupId</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span> <span style="color:#0000cf;font-weight:bold">30000</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">updateToolResponsePopup</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">popup</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">toolPopups</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tool_response</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">!</span><span style="color:#000">popup</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Update popup with response data
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">popup</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">className</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">`tool-popup </span><span style="color:#4e9a06">${</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tool_response</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">error</span> <span style="color:#ce5c00;font-weight:bold">?</span> <span style="color:#4e9a06">&#39;tool-error&#39;</span> <span style="color:#ce5c00;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;tool-response&#39;</span><span style="color:#4e9a06">}</span><span style="color:#4e9a06">`</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Update content with response...
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#8f5902;font-style:italic">// Auto-close after showing result
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>    <span style="color:#000">setTimeout</span><span style="color:#000;font-weight:bold">(()</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">closeToolPopup</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">event</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tool_response</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">id</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span> <span style="color:#0000cf;font-weight:bold">5500</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="model-and-tool-parameter-encoding">Model and Tool Parameter Encoding<a class="td-heading-self-link" href="#model-and-tool-parameter-encoding" aria-label="Heading self-link"></a></h3>
<p>The frontend <code>buildModelWithTools()</code> function implements the pipe-delimited encoding:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000">buildModelWithTools</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">let</span> <span style="color:#000">modelString</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">selectedModel</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">selectedTools</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">selectedTools</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">size</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">tools</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">length</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic">// Only add tools if not all are selected (all selected means use all tools)
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">const</span> <span style="color:#000">toolNames</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">Array</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">from</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">selectedTools</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">modelString</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#4e9a06">&#39;|&#39;</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">toolNames</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">join</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;|&#39;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">modelString</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>This ensures tool selection is properly encoded in the API request while maintaining OpenAI compatibility.</p>
<h2 id="technical-design-benefits">Technical Design Benefits<a class="td-heading-self-link" href="#technical-design-benefits" aria-label="Heading self-link"></a></h2>
<h3 id="event-driven-transparency">Event-Driven Transparency<a class="td-heading-self-link" href="#event-driven-transparency" aria-label="Heading self-link"></a></h3>
<p>The event system provides unprecedented visibility into AI decision-making:</p>
<ol>
<li><strong>Real-Time Feedback</strong>: Users see tool calls as they happen</li>
<li><strong>Detailed Information</strong>: Full argument and response data available</li>
<li><strong>Error Visibility</strong>: Tool failures are clearly communicated</li>
<li><strong>Learning Opportunity</strong>: Users understand how AI approaches problems</li>
</ol>
<h3 id="scalable-architecture">Scalable Architecture<a class="td-heading-self-link" href="#scalable-architecture" aria-label="Heading self-link"></a></h3>
<p>The channel-based streaming architecture scales well:</p>
<ol>
<li><strong>Non-Blocking</strong>: Event processing doesn&rsquo;t block the main request thread</li>
<li><strong>Backpressure Handling</strong>: Go channels provide natural backpressure</li>
<li><strong>Resource Management</strong>: Proper cleanup prevents memory leaks</li>
<li><strong>Error Isolation</strong>: Tool failures don&rsquo;t crash the entire system</li>
</ol>
<h3 id="openai-compatibility">OpenAI Compatibility<a class="td-heading-self-link" href="#openai-compatibility" aria-label="Heading self-link"></a></h3>
<p>The design maintains full OpenAI v1 API compatibility:</p>
<ol>
<li><strong>Standard Endpoints</strong>: No custom API modifications required</li>
<li><strong>Parameter Encoding</strong>: Tool selection uses existing model parameter</li>
<li><strong>Event Extensions</strong>: Additional events don&rsquo;t interfere with standard responses</li>
<li><strong>Client Compatibility</strong>: Existing OpenAI clients work unchanged</li>
</ol>
<h2 id="integration-points">Integration Points<a class="td-heading-self-link" href="#integration-points" aria-label="Heading self-link"></a></h2>
<h3 id="mcp-protocol-integration">MCP Protocol Integration<a class="td-heading-self-link" href="#mcp-protocol-integration" aria-label="Heading self-link"></a></h3>
<p>AgentFlow seamlessly integrates with the Model Context Protocol:</p>
<ol>
<li><strong>Tool Discovery</strong>: Automatic detection of MCP server capabilities</li>
<li><strong>Dynamic Loading</strong>: Tools can be added/removed without restart</li>
<li><strong>Protocol Abstraction</strong>: MCP details are hidden from the UI</li>
<li><strong>Error Handling</strong>: MCP errors are gracefully handled and displayed</li>
</ol>
<h3 id="vertex-ai-integration">Vertex AI Integration<a class="td-heading-self-link" href="#vertex-ai-integration" aria-label="Heading self-link"></a></h3>
<p>The Vertex AI backend provides:</p>
<ol>
<li><strong>Built-in Tools</strong>: Code execution, Google Search, etc.</li>
<li><strong>Model Selection</strong>: Multiple Gemini model variants</li>
<li><strong>Streaming Support</strong>: Native streaming for real-time responses</li>
<li><strong>Tool Mixing</strong>: Combines MCP tools with Vertex AI capabilities</li>
</ol>
<p>This comprehensive architecture enables AgentFlow to provide an intuitive, powerful interface for agentic interactions while maintaining compatibility with existing OpenAI tooling and providing deep visibility into the AI&rsquo;s decision-making process.</p>

</div>



    
	
  

    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub Issues" aria-label="GitHub Issues">
    <a target="_blank" rel="noopener" href="https://github.com/owulveryck/gomcptest/issues" aria-label="GitHub Issues">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/owulveryck/gomcptest" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2023&ndash;2025
    <span class="td-footer__authors">Olivier Wulveryck | <a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a> |</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span><span class="ms-2"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Privacy Policy</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/gomcptest/js/main.min.89aa145a2213e507c6ff43c902243d28aa02cb6ba1818926cb888252762ae53e.js" integrity="sha256-iaoUWiIT5QfG/0PJAiQ9KKoCy2uhgYkmy4iCUnYq5T4=" crossorigin="anonymous"></script>
<script defer src="/gomcptest/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js" integrity="sha256-c0eKfUgHaYrtfjVesj&#43;YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin="anonymous"></script>
<script src='/gomcptest/js/tabpane-persist.js'></script>

  </body>
</html>
